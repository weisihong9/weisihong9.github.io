{"meta":{"title":"WeiSH's BLOG","subtitle":"MaTRix","description":"","author":"weisihong","url":"https://weisihong9.github.io","root":"/"},"pages":[{"title":"å…³äº","date":"2024-05-16T11:49:05.950Z","updated":"2023-05-20T13:09:31.547Z","comments":false,"path":"about/index.html","permalink":"https://weisihong9.github.io/about/index.html","excerpt":"","text":"Weisihongï¼šç”Ÿå‘½ç§‘å­¦ä¸æŠ€æœ¯å­¦é™¢ï¼Œå¥åº·ä¸åº·å¤ç§‘å­¦ç ”ç©¶æ‰€çš„ç ”ç©¶ç”Ÿ ç ”ç©¶æ–¹å‘ï¼šä¿¡å·é¢„å¤„ç†ã€EEGä¸fNIRSå¤šæ¨¡æ€èåˆã€æ—¶é¢‘åˆ†æã€è„‘ç½‘ç»œåŠŸèƒ½è¿æ¥ç®—æ³•ã€æœºå™¨å­¦ä¹ ã€ç»Ÿè®¡åˆ†æ"},{"title":"ç•™è¨€","date":"2023-05-21T15:13:23.000Z","updated":"2023-05-21T15:34:41.059Z","comments":true,"path":"guestbook/index.html","permalink":"https://weisihong9.github.io/guestbook/index.html","excerpt":"","text":""},{"title":"åˆ†ç±»","date":"2024-05-16T11:48:57.934Z","updated":"2023-05-21T15:34:11.984Z","comments":false,"path":"categories/index.html","permalink":"https://weisihong9.github.io/categories/index.html","excerpt":"","text":""},{"title":"é¡¹ç›®ä»“åº“","date":"2023-05-21T15:34:31.651Z","updated":"2023-05-21T15:34:31.651Z","comments":false,"path":"repository/index.html","permalink":"https://weisihong9.github.io/repository/index.html","excerpt":"","text":""},{"title":"æ ‡ç­¾","date":"2023-05-21T15:34:49.343Z","updated":"2023-05-21T15:34:49.343Z","comments":false,"path":"tags/index.html","permalink":"https://weisihong9.github.io/tags/index.html","excerpt":"","text":""}],"posts":[{"title":"NeuroSignal Preprocessor","slug":"NeuroSignalPreprocessor","date":"2025-12-11T03:49:43.000Z","updated":"2026-01-04T03:43:21.970Z","comments":true,"path":"2025/12/11/NeuroSignalPreprocessor/","link":"","permalink":"https://weisihong9.github.io/2025/12/11/NeuroSignalPreprocessor/","excerpt":"","text":"NeuroSignal Preprocessor ä½¿ç”¨è¯´æ˜ 1. è½¯ä»¶ç®€ä»‹ NeuroSignal Preprocessor æ˜¯ä¸€æ¬¾ç”¨äº EEG / fNIRS / EMG ç¥ç»ä¿¡å·æ•°æ®çš„æ¡Œé¢é¢„å¤„ç†ä¸ç‰¹å¾æå–è½¯ä»¶ã€‚ æœ¬è½¯ä»¶ä¸»è¦é¢å‘å…¥é—¨è„‘ç§‘å­¦é¢†åŸŸçš„ç§‘ç ”äººå‘˜ï¼Œæä¾›ç®€æ´çš„å›¾å½¢åŒ–ç•Œé¢ï¼Œæ”¯æŒä»æ•°æ®åŠ è½½ã€é¢„å¤„ç†åˆ°ç‰¹å¾æå–çš„å®Œæ•´æµç¨‹ï¼Œæ— éœ€å®‰è£… Python ç¯å¢ƒï¼ŒåŒå‡»å³å¯è¿è¡Œã€‚ æœ¬è½¯ä»¶ç”±ä½œè€…åœ¨ç§‘ç ”å®è·µä¸­è‡ªä¸»å¼€å‘å¹¶æŒç»­ç»´æŠ¤ï¼Œä¸»è¦ç”¨äºç¥ç»ä¿¡å·æ•°æ®é¢„å¤„ç†ä¸ç‰¹å¾åˆ†æç ”ç©¶ã€‚ è½¯ä»¶åŠŸèƒ½ä»åœ¨ä¸æ–­å®Œå–„ä¸­ï¼Œç”±äºå®éªŒæ¡ä»¶ä¸æ•°æ®å·®å¼‚ï¼Œåœ¨ç‰¹å®šåœºæ™¯ä¸‹å¯èƒ½å­˜åœ¨æœªè¦†ç›–çš„è¾¹ç•Œæƒ…å†µã€‚ è½¯ä»¶è¾“å‡ºç»“æœä»…ä¾›ç§‘ç ”ä¸æ–¹æ³•æ¢ç´¢å‚è€ƒï¼Œä¸æ„æˆä»»ä½•ä¸´åºŠæˆ–å•†ä¸šç”¨é€”çš„ä¿è¯ã€‚ ç›¸å…³åˆ†æç»“æœåº”ç»“åˆå…·ä½“å®éªŒè®¾è®¡ä¸æ•°æ®ç‰¹æ€§è¿›è¡Œåˆç†è§£é‡Šã€‚ å¦‚åœ¨ä½¿ç”¨è¿‡ç¨‹ä¸­å‘ç°é—®é¢˜æˆ–æœ‰æ”¹è¿›å»ºè®®ï¼Œæ¬¢è¿åé¦ˆä»¥ååŠ©æ”¹è¿›ã€‚ ä¸‹è½½é“¾æ¥ğŸ”—ï¼šé€šè¿‡ç½‘ç›˜åˆ†äº«çš„æ–‡ä»¶ï¼šNeuroSignalPreprocessor.zip é“¾æ¥: https://pan.baidu.com/s/1Hz__D7FExQeWtObw0W0dwA æå–ç : 3hnt 2. ç³»ç»Ÿè¦æ±‚ä¸è¿è¡Œç¯å¢ƒ 2.1 æ“ä½œç³»ç»Ÿ Windows 10 / Windows 11ï¼ˆ64 ä½ï¼‰ 2.2 ç¡¬ä»¶å»ºè®® å†…å­˜ï¼š8 GBï¼ˆæ¨è 16 GB åŠä»¥ä¸Šï¼‰ ç£ç›˜ç©ºé—´ï¼šè‡³å°‘ 2 GB å¯ç”¨ç©ºé—´ 2.3 å¿…è¦è¿è¡Œåº“ æœ¬è½¯ä»¶ä¾èµ–ä»¥ä¸‹ç³»ç»Ÿè¿è¡Œåº“ï¼š Microsoft Visual C++ Redistributable 2015â€“2022ï¼ˆx64ï¼‰ è‹¥è½¯ä»¶æ— æ³•å¯åŠ¨æˆ–å¯åŠ¨æ—¶æŠ¥é”™ï¼Œè¯·ä¼˜å…ˆç¡®è®¤å·²å®‰è£…è¯¥è¿è¡Œåº“ã€‚ 3. å®‰è£…ä¸å¯åŠ¨æ–¹å¼ 3.1 æ–‡ä»¶ç»“æ„è¯´æ˜ è§£å‹åç›®å½•ç»“æ„å¦‚ä¸‹ï¼š 123NeuroSignalPreprocessor/â†©ï¸ â”œâ”€ NeuroSignalPreprocessor.exeâ†©ï¸ â”œâ”€ _internal/â†©ï¸ âš  è¯·å‹¿å•ç‹¬ç§»åŠ¨æˆ–å¤åˆ¶ exe æ–‡ä»¶ï¼Œå¿…é¡»ä¿ç•™æ•´ä¸ªæ–‡ä»¶å¤¹ç»“æ„ï¼Œå¦åˆ™è½¯ä»¶å°†æ— æ³•è¿è¡Œã€‚ 3.2 å¯åŠ¨æ–¹å¼ è¿›å…¥ NeuroSignalPreprocessor æ–‡ä»¶å¤¹ åŒå‡» NeuroSignalPreprocessor.exe è½¯ä»¶å¯åŠ¨åå°†æ˜¾ç¤ºä¸»ç•Œé¢ 4. è½¯ä»¶ç•Œé¢è¯´æ˜ å¯åŠ¨åè¿›å…¥ä¸»ç•Œé¢ï¼ŒåŒ…å«ä»¥ä¸‹ä¸‰ä¸ªæ¨¡å—ï¼š EEGï¼šè„‘ç”µä¿¡å·é¢„å¤„ç†ä¸ç‰¹å¾æå– fNIRSï¼šè¿‘çº¢å¤–è„‘åŠŸèƒ½æˆåƒä¿¡å·å¤„ç† EMGï¼šè‚Œç”µä¿¡å·å¤„ç† ç‚¹å‡»å¯¹åº”æ¨¡å—å³å¯è¿›å…¥åŠŸèƒ½é¡µé¢ã€‚ 5. EEGæ¨¡å—ä½¿ç”¨è¯´æ˜ 5.1. æ¨¡å—è®¾è®¡ç†å¿µ EEG æ¨¡å—åŸºäºæ ‡å‡†è„‘ç”µä¿¡å·å¤„ç†æµç¨‹è®¾è®¡ï¼Œæ•´ä½“æ€è·¯ä¸ MNE-Python / EEGLAB ç­‰ä¸»æµç§‘ç ”å·¥å…·ä¿æŒä¸€è‡´ï¼Œå¼ºè°ƒï¼š æµç¨‹å¯æ§ å‚æ•°å¯è§£é‡Š äººå·¥å¹²é¢„ä¸è‡ªåŠ¨å¤„ç†ç»“åˆ ç»“æœå¯å¤ç° æ¨èé¢„å¤„ç†æµç¨‹å¦‚ä¸‹ï¼š 123456789Load Dataâ†’ Mark Bad Channelsâ†’ Filterâ†’ ICAâ†’ Re-referenceâ†’ Interpolateâ†’ Epoch / Markâ†’ Feature Extractionâ†’ Save 5.2. æ•°æ®è½½å…¥ï¼ˆLoad Dataï¼‰ 5.2.1 æ•°æ®è½½å…¥ åœ¨ Load Data é¡µé¢ä¸­ï¼Œç”¨æˆ·å¯åŠ è½½åŸå§‹ EEG æ•°æ®æ–‡ä»¶ã€‚ ç³»ç»ŸåŸºäº MNE æ¡†æ¶è¯»å–æ•°æ®ï¼Œå¹¶ä¿æŒæ•°æ®ä¸º raw çŠ¶æ€ã€‚ é€šè¿‡ç‚¹å‡» Browse æŒ‰é’®æ‰“å¼€æ–‡ä»¶é€‰æ‹©å¯¹è¯æ¡†ï¼Œé€‰æ‹©ç›®æ ‡ EEG æ•°æ®æ–‡ä»¶å¹¶ç¡®è®¤ï¼Œå³å¯å®Œæˆæ•°æ®è½½å…¥ã€‚ 5.2.2 æ”¯æŒæ ¼å¼ .setï¼ˆEEGLABï¼‰ .fifï¼ˆMNEï¼‰ .edf / .bdf .vhdrï¼ˆBrainVisionï¼‰ 5.2.3 æ•°æ®çŠ¶æ€æŒ‡ç¤º åŠ è½½æˆåŠŸåï¼Œç•Œé¢å°†æ˜¾ç¤ºï¼š å½“å‰æ•°æ®çŠ¶æ€ï¼ˆrawï¼‰ EEG é€šé“æ•°é‡ ä¿¡å·é‡‡æ ·é¢‘ç‡å’Œæ—¶é•¿ é€šé“ä½ç½® é€šè¿‡ç‚¹å‡» Preview PSD æŒ‰é’®å¯æŸ¥çœ‹ä¿¡å·çš„åŠŸç‡è°±å¯†åº¦ 5.3. EEGé¢„å¤„ç† 5.3.1 åé“æ ‡è®°ï¼ˆBad Channelsï¼‰ åé“ï¼ˆBad Channelsï¼‰æ˜¯ EEG é¢„å¤„ç†ä¸­å¿…é¡»å¤„ç†çš„é—®é¢˜ï¼Œå¸¸è§åŸå› åŒ…æ‹¬ï¼š ç”µæè„±è½ é«˜é˜»æŠ— æŒç»­é«˜å™ªå£° è¿åŠ¨ä¼ªè¿¹ åœ¨åç»­æ»¤æ³¢ã€ICA å’Œé‡å‚è€ƒå‰ï¼Œæ˜ç¡®åé“åˆ—è¡¨è‡³å…³é‡è¦ã€‚ åœ¨ Mark Bad Channels é¡µé¢ä¸­ï¼Œç”¨æˆ·å¯ï¼š é¢„è§ˆåŸå§‹ä¿¡å·ï¼ˆPreview Rawï¼‰ æ‰‹åŠ¨é€‰æ‹©é€šé“å¹¶æ ‡è®°ä¸º bad æ’¤é”€ï¼ˆUndoï¼‰æ“ä½œ é€‰æ‹©åé“ï¼ˆBad Channelsï¼‰çš„æ–¹å¼ä¸»è¦æœ‰ä»¥ä¸‹ä¸¤ç§ï¼š åŸºäºåŸå§‹ä¿¡å·å¯è§†åŒ–æ ‡è®° ç‚¹å‡» Preview Raw æŒ‰é’®ï¼Œç³»ç»Ÿå°†å¼¹å‡ºåŸå§‹ EEG ä¿¡å·æµè§ˆçª—å£ åœ¨ä¿¡å·çª—å£ä¸­ï¼Œç”¨æˆ·å¯é€šè¿‡ç‚¹å‡»é€šé“åç§°é€‰æ‹©éœ€è¦æ ‡è®°ä¸ºåé“çš„é€šé“ è¢«é€‰ä¸­çš„é€šé“å°†ä»¥ç°è‰²æ˜¾ç¤ºä»¥ç¤ºåŒºåˆ† ç¡®è®¤é€‰æ‹©åï¼Œå…³é—­ä¿¡å·çª—å£ï¼Œæ‰€é€‰é€šé“å°†è¢«è‡ªåŠ¨è®°å½•ä¸ºåé“ åŸºäºé€šé“åˆ—è¡¨çš„æ‰‹åŠ¨æ ‡è®° ç”¨æˆ·äº¦å¯åœ¨ä¸»ç•Œé¢çš„é€šé“åˆ—è¡¨ä¸­ç›´æ¥é€‰æ‹©éœ€è¦æ ‡è®°çš„é€šé“ï¼Œ ç‚¹å‡» Add to bads æŒ‰é’®åï¼Œæ‰€é€‰é€šé“å°†è¢«åŠ å…¥åé“åˆ—è¡¨ï¼Œ å¹¶åœ¨ç•Œé¢ä¸‹æ–¹çš„ Current bads åŒºåŸŸä¸­å®æ—¶æ˜¾ç¤ºã€‚ å¦‚éœ€æ’¤é”€å·²æ ‡è®°çš„åé“ï¼Œå¯ç‚¹å‡» Undo æŒ‰é’®ä»¥æ¢å¤è‡³ä¸Šä¸€æ­¥çŠ¶æ€ã€‚ ç³»ç»Ÿä¼šå°†åé“ä¿¡æ¯å†™å…¥ raw.info['bads']ï¼Œï¼Œå¹¶åœ¨åç»­æ»¤æ³¢ã€ICAã€é‡å‚è€ƒåŠæ’å€¼è¿‡ç¨‹ä¸­è‡ªåŠ¨ç»§æ‰¿ã€‚ 5.3.2 EOG é€šé“æ ‡è®° (Mark EOG) é€šè¿‡ Mark EOG åŠŸèƒ½ï¼Œå¯æŒ‡å®šçœ¼ç”µé€šé“ï¼Œç”¨äºï¼š ICA ä¸­è‡ªåŠ¨è¯†åˆ«çœ¼åŠ¨ä¼ªè¿¹æˆåˆ† æé«˜ä¼ªè¿¹å»é™¤å‡†ç¡®æ€§ åœ¨æ•°æ®åŠ è½½é˜¶æ®µï¼Œç³»ç»Ÿå°†å¯¹é€šé“ç±»å‹è¿›è¡Œè‡ªåŠ¨æ£€æµ‹ï¼Œå¹¶å®Œæˆä»¥ä¸‹æ“ä½œï¼š è‡ªåŠ¨è¯†åˆ«çœ¼ç”µé€šé“ ç³»ç»Ÿå°†åœ¨æ•°æ®åŠ è½½å®Œæˆåè‡ªåŠ¨è¯†åˆ«å¯èƒ½çš„çœ¼ç”µé€šé“ï¼Œå¹¶å°†å…¶åŠ å…¥ Current EOG åˆ—è¡¨ä¸­ï¼Œä¾›åç»­å¤„ç†æµç¨‹ä½¿ç”¨ã€‚ è‡ªåŠ¨è¯†åˆ«ç»“æœçš„äººå·¥ä¿®æ­£ è‹¥è‡ªåŠ¨è¯†åˆ«çš„çœ¼ç”µé€šé“ä¸å®é™…é€šé“ç±»å‹ä¸ä¸€è‡´ï¼Œç”¨æˆ·å¯åœ¨é€šé“åˆ—è¡¨ä¸­é€‰ä¸­å¯¹åº”é€šé“ï¼› ç‚¹å‡» Set selected back to EEG æŒ‰é’®ï¼Œå°†è¯¥é€šé“æ¢å¤ä¸ºæ™®é€š EEG é€šé“ï¼Œä»è€Œæ’¤é”€çœ¼ç”µæ ‡è®°ã€‚ æ‰‹åŠ¨è¡¥å……çœ¼ç”µé€šé“ å¯¹äºæœªè¢«ç³»ç»Ÿè‡ªåŠ¨è¯†åˆ«çš„çœ¼ç”µé€šé“ï¼Œç”¨æˆ·å¯åœ¨é€šé“åˆ—è¡¨ä¸­æ‰‹åŠ¨é€‰ä¸­ç›¸åº”é€šé“; ç‚¹å‡» Set selected to EOG å°†å…¶æ ‡è®°ä¸º EOG é€šé“ï¼Œä½¿å…¶åŠ å…¥ Current EOG åˆ—è¡¨ã€‚ æ‰€æœ‰å·²ç¡®è®¤çš„ EOG é€šé“ä¿¡æ¯å°†è¢«ç”¨äº ICA é˜¶æ®µçš„ä¼ªè¿¹æˆåˆ†è¯†åˆ«ä¸åˆ†ç±»ï¼Œä»¥è¾…åŠ©çœ¼åŠ¨ä¼ªè¿¹çš„è‡ªåŠ¨æ£€æµ‹ä¸å»é™¤ã€‚ 5.3.3 æ»¤æ³¢ï¼ˆFILTERï¼‰ 1ï¼‰æ”¯æŒç±»å‹ å¸¦é€šæ»¤æ³¢ï¼ˆBand-passï¼‰ é™·æ³¢æ»¤æ³¢ï¼ˆNotchï¼‰ 2ï¼‰å¸¸ç”¨å‚æ•°å»ºè®®ï¼ˆç»éªŒå€¼ï¼‰ åœºæ™¯ ä½é¢‘ (Hz) é«˜é¢‘ (Hz) ERP 0.1 30 é¢‘è°±åˆ†æ 1 40 ICA å‰å¤„ç† 1 40 é™·æ³¢æ»¤æ³¢ï¼ˆNotch Filterï¼‰é€šå¸¸ç”¨äºå»é™¤ç”µæºå·¥é¢‘å¹²æ‰°ï¼Œå…¶å¸¸ç”¨è®¾ç½®å¦‚ä¸‹ï¼š 50 Hzï¼šé€‚ç”¨äºä¸­å›½ã€æ¬§æ´²ç­‰ä½¿ç”¨ 50 Hz å¸‚ç”µé¢‘ç‡çš„åœ°åŒº 60 Hzï¼šé€‚ç”¨äºåŒ—ç¾ç­‰ä½¿ç”¨ 60 Hz å¸‚ç”µé¢‘ç‡çš„åœ°åŒº åœ¨å®Œæˆæ»¤æ³¢å‚æ•°è®¾ç½®åï¼Œç‚¹å‡» Apply FILTER æŒ‰é’®ä»¥æ‰§è¡Œæ»¤æ³¢æ“ä½œã€‚ æ»¤æ³¢æˆåŠŸåï¼Œç•Œé¢ä¸‹æ–¹å°†æ˜¾ç¤ºæœ¬æ¬¡æ»¤æ³¢æ‰€ä½¿ç”¨çš„å‚æ•°ä¿¡æ¯ï¼Œå¹¶æç¤º Filter applied successfullyï¼Œä»¥ç¡®è®¤æ»¤æ³¢è¿‡ç¨‹å·²é¡ºåˆ©å®Œæˆã€‚ 5.3.4 ç‹¬ç«‹æˆåˆ†åˆ†æï¼šICA 1ï¼‰ç›®çš„ ç‹¬ç«‹æˆåˆ†åˆ†æï¼ˆIndependent Component Analysis, ICAï¼‰æ˜¯ä¸€ç§å¸¸ç”¨çš„ç›²æºåˆ†ç¦»æ–¹æ³•ï¼Œç”¨äºå°†å¤šé€šé“ EEG ä¿¡å·åˆ†è§£ä¸ºè‹¥å¹²ç»Ÿè®¡ç‹¬ç«‹çš„æˆåˆ†ï¼Œä»è€Œå®ç°å¯¹ç”Ÿç†ä¸éç”Ÿç†ä¼ªè¿¹çš„è¯†åˆ«ä¸å‰”é™¤ã€‚ åœ¨æœ¬è½¯ä»¶ä¸­ï¼ŒICA ä¸»è¦ç”¨äºåˆ†ç¦»å’Œå¤„ç†ä»¥ä¸‹å¸¸è§ä¼ªè¿¹æ¥æºï¼š çœ¼åŠ¨ä¼ªè¿¹ï¼ˆEOGï¼‰ï¼šçœ¨çœ¼ã€çœ¼çƒè½¬åŠ¨å¼•èµ·çš„ä½é¢‘å¤§å¹…åº¦ä¿¡å· å¿ƒç”µä¼ªè¿¹ï¼ˆECGï¼‰ï¼šå¿ƒè·³ç›¸å…³çš„å‘¨æœŸæ€§æˆåˆ† è‚Œç”µä¼ªè¿¹ï¼ˆEMGï¼‰ï¼šé«˜é¢‘ã€å±€éƒ¨åŒ–çš„è‚Œè‚‰æ´»åŠ¨ä¿¡å· é«˜é¢‘å™ªå£°ï¼šä¸çœŸå®è„‘æ´»åŠ¨æ— å…³çš„éšæœºæˆ–ç³»ç»Ÿæ€§å™ªå£° 2ï¼‰ICA å‚æ•°è¯´æ˜ n_componentsï¼ˆæˆåˆ†æ•°é‡ï¼‰ ç”¨äºæŒ‡å®š ICA åˆ†è§£æ—¶ä¿ç•™çš„æˆåˆ†æ•°é‡æˆ–æ•°æ®æ–¹å·®æ¯”ä¾‹ã€‚ å¸¸è§è®¾ç½®æ–¹å¼åŒ…æ‹¬ï¼š 0.95 / 0.99ï¼ˆæ¨èï¼‰ è¡¨ç¤ºä¿ç•™ 95% / 99% çš„æ•°æ®æ–¹å·®ï¼Œç³»ç»Ÿå°†æ ¹æ®æ•°æ®è‡ªåŠ¨ç¡®å®šå¯¹åº”çš„ ICA æˆåˆ†æ•°é‡ã€‚ è¯¥æ–¹å¼åœ¨ä¿è¯ä¸»è¦ä¿¡å·ä¿¡æ¯çš„åŒæ—¶ï¼Œæœ‰åŠ©äºå‡å°‘å™ªå£°ä¸è¿‡æ‹Ÿåˆï¼Œé€‚ç”¨äºå¤§å¤šæ•° EEG æ•°æ®åˆ†æåœºæ™¯ã€‚ æ•´æ•°å€¼ï¼ˆå¦‚ 20ã€30ã€50ï¼‰ è¡¨ç¤ºå›ºå®šæå–æŒ‡å®šæ•°é‡çš„ ICA æˆåˆ†ã€‚ é€‚ç”¨äºé€šé“æ•°é‡å›ºå®šã€å¯¹ ICA æˆåˆ†æ•°é‡æœ‰æ˜ç¡®ç»éªŒæˆ–å®éªŒè¦æ±‚çš„æƒ…å†µã€‚ ä½¿ç”¨å»ºè®®ï¼š è‹¥ä¸ç¡®å®šåº”æå–å¤šå°‘ä¸ªæˆåˆ†ï¼Œå»ºè®®ä¼˜å…ˆä½¿ç”¨ 0.95 æˆ– 0.99 ä½œä¸ºç»éªŒè®¾ç½®ã€‚ methodï¼ˆICA ç®—æ³•ï¼‰ ç”¨äºæŒ‡å®šæ‰§è¡Œ ICA åˆ†è§£æ‰€é‡‡ç”¨çš„ç®—æ³•ç±»å‹ã€‚ fasticaï¼ˆé»˜è®¤ï¼‰ ä¸€ç§è®¡ç®—æ•ˆç‡é«˜ã€åœ¨ EEG æ•°æ®åˆ†æä¸­åº”ç”¨å¹¿æ³›çš„ ICA ç®—æ³•ï¼Œ åœ¨å¤§å¤šæ•°å¸¸è§„é¢„å¤„ç†ä»»åŠ¡ä¸­èƒ½å¤Ÿæä¾›ç¨³å®šå¯é çš„åˆ†è§£ç»“æœã€‚ random_stateï¼ˆéšæœºç§å­ï¼‰ ç”¨äºæ§åˆ¶ ICA ç®—æ³•ä¸­çš„éšæœºåˆå§‹åŒ–è¿‡ç¨‹ã€‚ è®¾ç½®å›ºå®šçš„ random_stateï¼ˆå¦‚ 97ï¼‰ï¼Œ å¯ä¿è¯åœ¨ç›¸åŒæ•°æ®ä¸å‚æ•°æ¡ä»¶ä¸‹å¤šæ¬¡è¿è¡Œ ICA å¾—åˆ°ä¸€è‡´çš„ç»“æœï¼Œ æœ‰åŠ©äºæé«˜åˆ†ææµç¨‹çš„å¯å¤ç°æ€§ä¸ç§‘ç ”ä¸€è‡´æ€§ã€‚ å‚æ•°è®¾ç½®å»ºè®® å¸¸è§„é¢„å¤„ç† / åˆæ¬¡ä½¿ç”¨ n_components = 0.95 method = fastica random_state ä¿æŒé»˜è®¤å€¼ éœ€è¦ä¸¥æ ¼å¤ç°å®éªŒç»“æœ å›ºå®š random_state æ•°å€¼ å¯¹ ICA æˆåˆ†æ•°é‡æœ‰æ˜ç¡®ç»éªŒ ä½¿ç”¨æ•´æ•°å½¢å¼çš„ n_components 3ï¼‰ æ‰§è¡Œ ICA åˆ†è§£ï¼ˆFit ICAï¼‰ ç‚¹å‡» Fit ICA æŒ‰é’®åï¼Œç³»ç»Ÿå°†åœ¨å½“å‰å·²å®Œæˆæ»¤æ³¢ä¸åé“æ ‡è®°çš„æ•°æ®åŸºç¡€ä¸Šæ‰§è¡Œ ICA åˆ†è§£ã€‚ ICA æ‹Ÿåˆå®Œæˆåï¼Œç³»ç»Ÿå°†è‡ªåŠ¨å¼¹å‡º ICA æˆåˆ†å¯è§†åŒ–çª—å£ï¼ŒåŒ…æ‹¬ï¼š æˆåˆ†ç©ºé—´åˆ†å¸ƒï¼ˆå¤´çš®åœ°å½¢å›¾, topographyï¼‰ æˆåˆ†æ—¶é—´åºåˆ—ï¼ˆICA sourcesï¼‰ è¿™äº›å¯è§†åŒ–ç»“æœç”¨äºè¾…åŠ©ç”¨æˆ·åˆ¤æ–­å„ç‹¬ç«‹æˆåˆ†çš„ç‰©ç†ä¸ç”Ÿç†æ„ä¹‰ã€‚ 4ï¼‰ICA æˆåˆ†åˆ¤åˆ«ä¸é€‰æ‹© åœ¨ ICA æˆåˆ†çª—å£ä¸­ï¼Œç”¨æˆ·å¯åŸºäºä»¥ä¸‹ä¿¡æ¯å¯¹æˆåˆ†è¿›è¡Œåˆ¤åˆ«ï¼š æˆåˆ†æ—¶é—´åºåˆ—çš„æ³¢å½¢ç‰¹å¾ï¼ˆå¦‚çœ¨çœ¼ç›¸å…³çš„å°–å³°æˆ–ç¼“æ…¢æ¼‚ç§»ï¼‰ æˆåˆ†å¤´çš®åˆ†å¸ƒç‰¹å¾ï¼ˆå¦‚é¢åŒºä¸»å¯¼çš„çœ¼åŠ¨æ¨¡å¼ï¼‰ ä¸ EOG é€šé“çš„ç›¸å…³æ€§ï¼ˆè‹¥å·²æ­£ç¡®è®¾ç½® EOG é€šé“ï¼‰ æˆåˆ†é€‰æ‹©æ–¹å¼ï¼š ç‚¹å‡»éœ€è¦å‰”é™¤çš„ ICA æˆåˆ†ï¼Œå¯¹åº”æˆåˆ†å°†è¢«é«˜äº®/ç½®ç°æ ‡è®° ç¡®è®¤é€‰æ‹©åï¼Œå…³é—­æˆåˆ†çª—å£ è¢«é€‰ä¸­çš„æˆåˆ†ç¼–å·å°†æ˜¾ç¤ºåœ¨ä¸»ç•Œé¢çš„ Excluded comps ä¿¡æ¯åŒºåŸŸä¸­ 5ï¼‰ç¼–è¾‘å·²é€‰æ‹©çš„æˆåˆ†ï¼ˆEdit excluded compsï¼‰ è‹¥éœ€å¯¹å·²é€‰æ‹©çš„å‰”é™¤æˆåˆ†è¿›è¡Œä¿®æ”¹ï¼Œå¯ç‚¹å‡» Edit excluded comps æŒ‰é’® ç³»ç»Ÿå°†å¼¹å‡ºæˆåˆ†åˆ—è¡¨çª—å£ï¼Œç”¨æˆ·å¯ï¼š å‹¾é€‰æˆ–å–æ¶ˆå‹¾é€‰éœ€è¦å‰”é™¤çš„ ICA æˆåˆ† ä¿å­˜æ›´æ–°åçš„å‰”é™¤åˆ—è¡¨ 6ï¼‰åº”ç”¨ ICA å»ä¼ªè¿¹ï¼ˆApply ICAï¼‰ åœ¨ç¡®è®¤éœ€è¦å‰”é™¤çš„æˆåˆ†åï¼Œç‚¹å‡» Apply ICA (exclude selected comps) æŒ‰é’® ç³»ç»Ÿå°†åŸºäºæ‰€é€‰æˆåˆ†ï¼Œå¯¹åŸå§‹æ•°æ®è¿›è¡Œé‡æ„å¹¶ç§»é™¤å¯¹åº”ä¼ªè¿¹æˆåˆ† ICA åº”ç”¨å®Œæˆåï¼Œç³»ç»Ÿå°†è‡ªåŠ¨å¼¹å‡ºç»“æœå¯è§†åŒ–çª—å£ï¼Œç”¨äºå¯¹å»ä¼ªè¿¹æ•ˆæœè¿›è¡Œç›´è§‚è¯„ä¼°ã€‚ è¯¥å¯è§†åŒ–çª—å£é€šå¸¸åŒ…æ‹¬ä»¥ä¸‹å†…å®¹ï¼š åŸå§‹ä¿¡å·ä¸æ¸…ç†åä¿¡å·å¯¹æ¯” ä»¥ä¸åŒé¢œè‰²æ˜¾ç¤º ICA åº”ç”¨å‰ï¼ˆå¦‚çº¢è‰²ï¼‰ä¸åº”ç”¨åï¼ˆå¦‚é»‘è‰²ï¼‰çš„ EEG ä¿¡å·ï¼Œç”¨äºç›´è§‚è§‚å¯Ÿä¼ªè¿¹å»é™¤æ•ˆæœã€‚ å…¨å±€åœºåŠŸç‡ï¼ˆGlobal Field Power, GFPï¼‰å˜åŒ– å¯¹æ¯”æ¸…ç†å‰å EEG çš„æ•´ä½“èƒ½é‡åˆ†å¸ƒå˜åŒ–ï¼Œè¾…åŠ©è¯„ä¼°å¤§å¹…åº¦ä¼ªè¿¹æ˜¯å¦å¾—åˆ°æœ‰æ•ˆæŠ‘åˆ¶ã€‚ è·¨é€šé“å¹³å‡ä¿¡å·å¯¹æ¯” å±•ç¤ºæ‰€æœ‰ EEG é€šé“å¹³å‡ä¿¡å·åœ¨ ICA åº”ç”¨å‰åçš„å˜åŒ–è¶‹åŠ¿ï¼Œä»¥åˆ¤æ–­æ•´ä½“ä¿¡å·ç¨³å®šæ€§æ˜¯å¦å¾—åˆ°æ”¹å–„ã€‚ é€šè¿‡ä¸Šè¿°å¯è§†åŒ–ç»“æœï¼Œç”¨æˆ·å¯ç»¼åˆåˆ¤æ–­ ICA æˆåˆ†å‰”é™¤æ˜¯å¦åˆç†ï¼Œåœ¨ç¡®è®¤ç»“æœæ»¡æ„åï¼Œå¯ç»§ç»­æ‰§è¡Œåç»­çš„é‡å‚è€ƒã€åé“æ’å€¼æˆ– epoch åˆ‡åˆ†ç­‰å¤„ç†æµç¨‹ã€‚ 7ï¼‰ç§‘ç ”ä½¿ç”¨å»ºè®®ä¸æ³¨æ„äº‹é¡¹ å»ºè®®åœ¨ å®Œæˆæ»¤æ³¢ä¸åé“æ ‡è®°ä¹‹å å†æ‰§è¡Œ ICA ICA æˆåˆ†å‰”é™¤åº”ç»“åˆè‡ªåŠ¨è¾…åŠ©ç»“æœä¸äººå·¥åˆ¤æ–­ï¼Œé¿å…è¿‡åº¦å»é™¤çœŸå®è„‘ä¿¡å· æ¨èè®°å½•æ¯æ¬¡ ICA ä½¿ç”¨çš„å‚æ•°ä¸è¢«å‰”é™¤æˆåˆ†ç¼–å·ï¼Œä»¥ä¿è¯åˆ†æè¿‡ç¨‹çš„å¯å¤ç°æ€§ 5.3.5 é‡å‚è€ƒï¼ˆRe-referenceï¼‰ é‡å‚è€ƒç”¨äºé‡æ–°å®šä¹‰ EEG ä¿¡å·çš„å‚è€ƒåŸºå‡†ï¼Œå¯¹ä¿¡å·å¹…å€¼åˆ†å¸ƒä¸ç©ºé—´æ‹“æ‰‘å…·æœ‰é‡è¦å½±å“ã€‚ æœ¬è½¯ä»¶æ”¯æŒä»¥ä¸‹ä¸¤ç§å¸¸ç”¨é‡å‚è€ƒæ–¹å¼ï¼š å¹³å‡å‚è€ƒï¼ˆAverage Referenceï¼‰ å°†æ‰€æœ‰æœ‰æ•ˆ EEG é€šé“çš„å¹³å‡ä¿¡å·ä½œä¸ºå‚è€ƒåŸºå‡†ï¼Œ æœ‰åŠ©äºå‡å°‘å•ä¸€å‚è€ƒç”µæå¸¦æ¥çš„åç½®ï¼Œé€‚ç”¨äºé€šé“åˆ†å¸ƒè¾ƒä¸ºå‡åŒ€çš„é«˜å¯†åº¦ EEG æ•°æ®ã€‚ æŒ‡å®šå‚è€ƒé€šé“ï¼ˆCustom Referenceï¼‰ é€‰æ‹©ä¸€ä¸ªæˆ–å¤šä¸ªç‰¹å®šé€šé“ä½œä¸ºå‚è€ƒåŸºå‡†ï¼Œ é€‚ç”¨äºå®éªŒèŒƒå¼ä¸­å·²æ˜ç¡®å‚è€ƒç”µæä½ç½®æˆ–éœ€ä¸æ—¢å¾€ç ”ç©¶ä¿æŒä¸€è‡´çš„æƒ…å†µã€‚ ç¡®è®¤å‚è€ƒæ–¹å¼åï¼Œç‚¹å‡» Apply Reference æŒ‰é’®ä»¥åº”ç”¨é‡å‚è€ƒæ“ä½œã€‚ 5.3.6 åé“æ’å€¼ï¼ˆInterpolateï¼‰ åé“æ’å€¼ç”¨äºå¯¹å·²æ ‡è®°çš„åé“è¿›è¡Œç©ºé—´é‡å»ºï¼Œä»¥å‡å°‘é€šé“ç¼ºå¤±å¯¹æ•°æ®å®Œæ•´æ€§å’Œç©ºé—´åˆ†æçš„å½±å“ã€‚ æ’å€¼åŸºäºç”µæç©ºé—´ä½ç½®ä¸å¤´æ¨¡å‹ä¿¡æ¯ï¼Œåˆ©ç”¨é‚»è¿‘é€šé“ä¿¡å·å¯¹åé“è¿›è¡Œä¼°è®¡é‡å»º è¯¥æ“ä½œæœ‰åŠ©äºåœ¨ä¿ç•™æ•´ä½“ç©ºé—´æ‹“æ‰‘ç»“æ„çš„åŒæ—¶ï¼Œé™ä½å› åé“å‰”é™¤å¸¦æ¥çš„æ•°æ®æŸå¤± Reset bads after interpolationï¼ˆå¯é€‰ï¼‰ è¯¥é€‰é¡¹ç”¨äºæ§åˆ¶æ’å€¼å®Œæˆåï¼ŒåŸå…ˆæ ‡è®°ä¸ºåé“ï¼ˆbad channelsï¼‰çš„é€šé“çŠ¶æ€æ˜¯å¦é‡ç½®ã€‚ å‹¾é€‰è¯¥é€‰é¡¹ï¼š æ’å€¼å®Œæˆåï¼Œå·²æ’å€¼é‡å»ºçš„é€šé“å°†è¢«ä»åé“åˆ—è¡¨ä¸­ç§»é™¤ï¼Œå¹¶é‡æ–°ä½œä¸ºæœ‰æ•ˆ EEG é€šé“å‚ä¸åç»­åˆ†æã€‚ æœªå‹¾é€‰è¯¥é€‰é¡¹ï¼š æ’å€¼å®Œæˆåï¼Œé€šé“ä¿¡å·å·²è¢«é‡å»ºï¼Œä½†å…¶åé“æ ‡è®°å°†è¢«ä¿ç•™ï¼Œåœ¨åç»­åˆ†æä¸­ä»ä¼šè¢«è§†ä¸ºåŸå§‹åé“ï¼Œä»…ç”¨äºä¿æŒå¤„ç†è®°å½•çš„å¯è¿½æº¯æ€§ã€‚ è¯¥è®¾ç½®ä¸ä¼šå½±å“æ’å€¼æœ¬èº«çš„è®¡ç®—ç»“æœï¼Œä»…å½±å“é€šé“åœ¨åç»­æµç¨‹ä¸­çš„æ ‡è®°çŠ¶æ€ã€‚ ç¡®è®¤æ— è¯¯åç‚¹å‡» Interpolate bads æŒ‰é’®ä»¥æ‰§è¡Œæ’å€¼æ“ä½œã€‚ 5.3.7 ä¿å­˜ç»“æœ é¢„å¤„ç†å®Œæˆåï¼Œå¯å°†å½“å‰å¤„ç†çŠ¶æ€ä¸‹çš„æ•°æ®ä¿å­˜åˆ°æœ¬åœ°æ–‡ä»¶ã€‚ æ”¯æŒä¿å­˜ä¸º FIFï¼ˆ.fifï¼‰ã€EDFï¼ˆ.edfï¼‰ æˆ– CSVï¼ˆchannels Ã— timeï¼‰ ç­‰æ ¼å¼ï¼Œå…·ä½“æ ¼å¼å¯åœ¨ç•Œé¢ä¸­é€‰æ‹©ã€‚ ä¿å­˜æ“ä½œä»…ä½œç”¨äºå½“å‰å¤„ç†åçš„æ•°æ®å‰¯æœ¬ï¼Œä¸ä¼šä¿®æ”¹åŸå§‹æ•°æ®æ–‡ä»¶ã€‚ ç¡®è®¤ä¿å­˜æ ¼å¼åï¼Œç‚¹å‡» Save current data æŒ‰é’®å³å¯å®Œæˆæ•°æ®å¯¼å‡ºã€‚ 5.4 ç‰¹å¾æå– å½“å‰æ”¯æŒç‰¹å¾ç±»å‹ æ—¶åŸŸç‰¹å¾ é¢‘åŸŸç‰¹å¾ åŠŸèƒ½è¿æ¥ç‰¹å¾ 5.4.1 Epoch / äº‹ä»¶æ ‡è®°ï¼ˆEpoch / Markï¼‰ è¯¥æ¨¡å—ç”¨äºå°†è¿ç»­ EEG ä¿¡å·åˆ‡åˆ†ä¸ºä¸äº‹ä»¶ï¼ˆåˆºæ¿€/æ ‡è®°ï¼‰ç›¸å…³çš„æ—¶é—´ç‰‡æ®µï¼ˆepochsï¼‰ï¼Œä»¥æ”¯æŒåç»­çš„äº‹ä»¶ç›¸å…³åˆ†æã€‚ 1) æ”¯æŒæ¨¡å¼ è¿ç»­æ•°æ®æ¨¡å¼ï¼šä¸è¿›è¡Œäº‹ä»¶åˆ‡åˆ†ï¼Œä¿ç•™è¿ç»­ä¿¡å·ç»“æ„ã€‚ æŒ‰æ ‡è®°åˆ‡åˆ† Epochï¼šåŸºäºæ•°æ®é‡‡é›†è¿‡ç¨‹ä¸­è®°å½•çš„äº‹ä»¶æ ‡è®°ï¼ˆmarks / annotationsï¼‰æ„å»º epochsã€‚ 2) æŒ‰ Mark åˆ‡åˆ† Epoch åœ¨é€‰æ‹© â€œæŒ‰ mark åˆ‡ epochâ€ æ¨¡å¼åï¼Œç³»ç»Ÿå°†ä»¥è¡¨æ ¼å½¢å¼åˆ—å‡ºå½“å‰æ•°æ®ä¸­æ£€æµ‹åˆ°çš„äº‹ä»¶æ ‡è®°ï¼ŒåŒ…æ‹¬å„æ ‡è®°çš„ç¼–å·åŠå‡ºç°æ¬¡æ•°ã€‚ ç”¨æˆ·å¯è¿›è¡Œä»¥ä¸‹è®¾ç½®ï¼š Mark æ¥æºï¼šé€‰æ‹©äº‹ä»¶æ ‡è®°æ¥æºï¼ˆå¦‚ Annotationsï¼‰ æ—¶é—´çª—è®¾ç½®ï¼š tminï¼šäº‹ä»¶å‰æ—¶é—´ï¼ˆç§’ï¼‰ tmaxï¼šäº‹ä»¶åæ—¶é—´ï¼ˆç§’ï¼‰ åŸºçº¿æ ¡æ­£ï¼ˆbaselineï¼‰ï¼šè®¾ç½®åŸºçº¿åŒºé—´æˆ–é€‰æ‹©ä¸è¿›è¡ŒåŸºçº¿æ ¡æ­£ 3) æ„å»º Epochs å•å‡»é€‰ä¸­è¡¨æ ¼ä¸­éœ€è¦åˆ†æçš„äº‹ä»¶æ ‡è®°ï¼ˆmarkï¼‰ ç‚¹å‡» æ„å»º epochs æŒ‰é’®æ‰§è¡Œåˆ‡åˆ†æ“ä½œ æ„å»ºæˆåŠŸåï¼Œç•Œé¢ä¸‹æ–¹å°†æ˜¾ç¤º epoch çŠ¶æ€ä¿¡æ¯ï¼ŒåŒ…æ‹¬ï¼š æ˜¯å¦å·²æˆåŠŸæ„å»º epoch æ•°é‡ï¼ˆn_epochsï¼‰ å½“å‰æ‰€é€‰äº‹ä»¶æ ‡è®°ç¼–å· è¯¥ç»“æœå¯ç›´æ¥ç”¨äºåç»­çš„ç‰¹å¾æå–ã€æ—¶é¢‘åˆ†ææˆ–åŠŸèƒ½è¿æ¥åˆ†æã€‚ 5.4.2 æ—¶åŸŸç‰¹å¾ï¼šç†µç‰¹å¾ è¯¥æ¨¡å—ç”¨äºä» EEG ä¿¡å·ä¸­æå–å¤šç§ç†µç±»ç‰¹å¾ï¼Œä»¥é‡åŒ–ä¿¡å·çš„å¤æ‚æ€§ä¸ä¸ç¡®å®šæ€§ã€‚ ç”¨æˆ·å¯æ ¹æ®ç ”ç©¶éœ€æ±‚é€‰æ‹©ä¸åŒçš„ç†µç±»å‹ï¼ˆå¦‚ Shannon ç†µã€è°±ç†µã€æ’åˆ—ç†µç­‰ï¼‰ï¼Œå¹¶è®¾ç½®ç›¸åº”å‚æ•°åæ‰§è¡Œç‰¹å¾è®¡ç®—ã€‚ åœ¨ç¡®è®¤å‚æ•°é…ç½®åï¼Œç‚¹å‡» æå–ç‰¹å¾ æŒ‰é’®å³å¯å®Œæˆç†µç‰¹å¾æå–ï¼Œç»“æœå°†ä»¥é€šé“ä¸ºå•ä½è¿›è¡Œæ±‡æ€»ï¼Œå¹¶å¯å¯¼å‡ºç”¨äºåç»­ç»Ÿè®¡åˆ†ææˆ–æœºå™¨å­¦ä¹ å»ºæ¨¡ã€‚ 5.4.3 æ—¶é¢‘ç‰¹å¾ï¼ˆTimeâ€“Frequency / ERSPï¼‰ï¼šæ—¶é¢‘è°± è¯¥æ¨¡å—ç”¨äºå¯¹ EEG ä¿¡å·è¿›è¡Œæ—¶é¢‘åˆ†æï¼Œä»¥åˆ»ç”»ä¸åŒé¢‘æ®µåŠŸç‡éšæ—¶é—´çš„åŠ¨æ€å˜åŒ–ï¼Œå¸¸ç”¨äºäº‹ä»¶ç›¸å…³å»åŒæ­¥/åŒæ­¥ï¼ˆERD/ERSï¼‰åˆ†æã€‚ 1ï¼‰è®¡ç®—æ–¹æ³• å¯é€‰æ‹© Morlet å°æ³¢å˜æ¢ æˆ– Multitaper å¯¹ epochs æ•°æ®è¿›è¡Œæ—¶é¢‘åˆ†è§£ æ”¯æŒè‡ªå®šä¹‰ï¼š é¢‘ç‡èŒƒå›´ï¼ˆfmin â€“ fmaxï¼‰ é¢‘ç‡åˆ†è¾¨ç‡ï¼ˆn_freqsï¼‰ å°æ³¢å‘¨æœŸæ•°ï¼ˆn_cyclesï¼‰ æ—¶é—´å¸¦å®½å‚æ•° 2ï¼‰åŸºçº¿æ ¡æ­£ æ”¯æŒè‡ªåŠ¨æˆ–è‡ªå®šä¹‰åŸºçº¿åŒºé—´ å¯è¾“å‡ºç›¸å¯¹åŸºçº¿çš„åŠŸç‡å˜åŒ–ï¼ˆå¦‚ç™¾åˆ†æ¯”å½¢å¼ï¼‰ 3ï¼‰å¯è§†åŒ–ä¸è¾“å‡º æ”¯æŒæŒ‰å•é€šé“æˆ–é€šé“å¹³å‡æ–¹å¼æ˜¾ç¤ºç»“æœ å¯é€‰æ‹©ç‰¹å®šé¢‘æ®µï¼ˆå¦‚ Î±ã€Î² æ³¢æ®µï¼‰è¿›è¡Œ ERD/ERS åˆ†æï¼ˆé€‰æ‹©åéœ€ç‚¹å‡» æ›´æ–°å›¾åƒ æŒ‰é’®ï¼‰ ç»“æœå¯å¯¼å‡ºç”¨äºåç»­ç»Ÿè®¡åˆ†ææˆ–æœºå™¨å­¦ä¹ å»ºæ¨¡ 5.4.4 åŠŸèƒ½è¿æ¥ è¯¥æ¨¡å—ç”¨äºè®¡ç®— EEG é€šé“é—´çš„åŠŸèƒ½è¿æ¥å…³ç³»ï¼Œä»¥åˆ»ç”»è„‘åŒºä¹‹é—´çš„åŒæ­¥æ€§ä¸ä¿¡æ¯äº¤äº’æ¨¡å¼ã€‚ å¯é€‰æ‹©é¢„å®šä¹‰é¢‘æ®µï¼ˆÎ´ã€Î¸ã€Î±ã€Î² ç­‰ï¼‰æˆ–è‡ªå®šä¹‰é¢‘ç‡èŒƒå›´ 1) è¿æ¥æŒ‡æ ‡ Coherenceï¼ˆç›¸å¹²æ€§ï¼‰ åŸºäºé¢‘åŸŸçš„çº¿æ€§ç›¸å…³åº¦é‡ï¼Œåæ˜ ä¸¤ä¸ªé€šé“åœ¨ç‰¹å®šé¢‘æ®µå†…çš„å¹…å€¼ä¸ç›¸ä½ä¸€è‡´æ€§ã€‚é€‚ç”¨äºåˆ†æç¨³å®šçš„æŒ¯è¡åŒæ­¥ï¼Œä½†å¯¹ä½“ç§¯ä¼ å¯¼è¾ƒä¸ºæ•æ„Ÿã€‚ COHï¼ˆComplex Coherenceï¼‰ å¤æ•°å½¢å¼çš„ç›¸å¹²æ€§ï¼Œä¿ç•™ç›¸ä½å·®ä¿¡æ¯ï¼Œå¯ç”¨äºæ›´ç²¾ç»†çš„é¢‘åŸŸè¿æ¥åˆ†æã€‚ PLVï¼ˆPhase Locking Valueï¼‰ åŸºäºç›¸ä½ä¸€è‡´æ€§çš„éçº¿æ€§æŒ‡æ ‡ï¼Œç”¨äºè¡¡é‡ä¿¡å·é—´ç›¸ä½åŒæ­¥ç¨‹åº¦ï¼Œå¯¹å¹…å€¼å˜åŒ–ä¸æ•æ„Ÿï¼Œå¸¸ç”¨äºäº‹ä»¶ç›¸å…³æˆ–ä»»åŠ¡æ€åˆ†æã€‚ å¯å‚è€ƒï¼šhttps://blog.csdn.net/qq_45538220/article/details/124435846?spm=1001.2014.3001.5501 PLIï¼ˆPhase Lag Indexï¼‰ åŸºäºç›¸ä½æ»åçš„è¿æ¥æŒ‡æ ‡ï¼Œå¯åœ¨ä¸€å®šç¨‹åº¦ä¸ŠæŠ‘åˆ¶é›¶æ—¶æ»åŒæ­¥å¸¦æ¥çš„ä½“ç§¯ä¼ å¯¼å½±å“ï¼Œæ›´å¼ºè°ƒå…·æœ‰æ–¹å‘æ€§çš„ç›¸ä½å…³ç³»ã€‚ wPLIï¼ˆWeighted Phase Lag Indexï¼‰ PLI çš„åŠ æƒæ”¹è¿›ç‰ˆæœ¬ï¼Œé€šè¿‡å¢å¼ºç¨³å®šç›¸ä½æ»åæˆåˆ†ï¼Œæé«˜å¯¹å™ªå£°çš„é²æ£’æ€§ï¼Œåœ¨åŠŸèƒ½è„‘ç½‘ç»œç ”ç©¶ä¸­è¢«å¹¿æ³›é‡‡ç”¨ã€‚ å¯å‚è€ƒï¼šhttps://blog.csdn.net/qq_45538220/article/details/129873029?spm=1001.2014.3001.5501 2) è¿æ¥çŸ©é˜µä¸å¯è§†åŒ– è®¡ç®—ç»“æœä»¥é€šé“ Ã— é€šé“çš„è¿æ¥çŸ©é˜µå½¢å¼è¡¨ç¤º æ”¯æŒæ˜¾ç¤ºè¿æ¥å¼ºåº¦çƒ­å›¾ å¯æå– Top-K å¼ºè¿æ¥è¾¹ ä»¥çªå‡ºä¸»è¦åŠŸèƒ½è¿æ¥æ¨¡å¼ 3) ç½‘ç»œåˆ†æ åŸºäºè¿æ¥çŸ©é˜µæ„å»ºåŠŸèƒ½è„‘ç½‘ç»œ æ”¯æŒé˜ˆå€¼æˆ– Top-K æ–¹å¼æ„å›¾ å¯è¿›ä¸€æ­¥è®¡ç®—å›¾è®ºæŒ‡æ ‡ï¼ˆå¦‚èŠ‚ç‚¹åº¦ã€èšç±»ç³»æ•°ç­‰ï¼‰ï¼Œç”¨äºè„‘ç½‘ç»œæ‹“æ‰‘åˆ†æ 4ï¼‰æ—¥å¿—ï¼ˆLogï¼‰ æ—¥å¿—æ¨¡å—ç”¨äºè®°å½•ç”¨æˆ·åœ¨è½¯ä»¶ä¸­çš„å…³é”®æ“ä½œä¸æ•°æ®å¤„ç†è¿‡ç¨‹ï¼Œä»¥å¢å¼ºåˆ†ææµç¨‹çš„å¯è¿½æº¯æ€§ä¸ç»“æœçš„å¯å¤ç°æ€§ã€‚ æ—¥å¿—ä¿¡æ¯åŒ…æ‹¬ä½†ä¸é™äºï¼š æ•°æ®è½½å…¥ä¸çŠ¶æ€æ›´æ–°ï¼ˆå¦‚ raw / epoch / æ’å€¼çŠ¶æ€ï¼‰ äº‹ä»¶æ ‡è®°ä¸ epoch æ„å»ºç»“æœ å„ç±»ç‰¹å¾è®¡ç®—çš„å¯åŠ¨ä¸å®ŒæˆçŠ¶æ€ ç‰¹å¾ç±»åˆ«ã€æ‰€ç”¨æ–¹æ³•åŠå…³é”®å‚æ•°é…ç½® æ•°æ®ç»´åº¦ä¿¡æ¯ï¼ˆå¦‚ epoch æ•°ã€é€šé“æ•°ã€æ—¶é—´ç‚¹æ•°ï¼‰ åŠŸèƒ½è¿æ¥ä¸ç½‘ç»œåˆ†æçš„ç»Ÿè®¡æ‘˜è¦ æ—¥å¿—å†…å®¹æŒ‰æ—¶é—´é¡ºåºå®æ—¶æ›´æ–°ï¼Œå¯ä½œä¸ºåç»­ç»“æœæ ¸æŸ¥ã€å‚æ•°å¤ç°åŠç§‘ç ”è®°å½•çš„é‡è¦å‚è€ƒã€‚ 6. fNIRSæ¨¡å—ä½¿ç”¨è¯´æ˜ æœ¬æ¨¡å—ç”¨äºå®Œæˆ fNIRS æ•°æ®çš„è½½å…¥ã€é¢„å¤„ç†ã€äº‹ä»¶åˆ‡åˆ†åŠç‰¹å¾æå–ï¼Œæ”¯æŒåŸºäºè¡€çº¢è›‹ç™½æµ“åº¦å˜åŒ–çš„ä»»åŠ¡ç›¸å…³åˆ†æã€‚ 6.1 è½½å…¥æ•°æ®ï¼ˆLoad Dataï¼‰ åœ¨ Load Data é¡µé¢ä¸­ï¼Œé€‰æ‹©å¹¶åŠ è½½ fNIRS æ•°æ®æ–‡ä»¶ã€‚ ç³»ç»Ÿå°†è‡ªåŠ¨è¯»å–é€šé“ä¿¡æ¯ã€é‡‡æ ·ç‡åŠè®°å½•æ—¶é•¿ï¼Œå¹¶åˆå§‹åŒ–æ•°æ®çŠ¶æ€ã€‚ åŠ è½½å®Œæˆåï¼Œå¯é¢„è§ˆåŸå§‹ä¿¡å·åŠæ¢å¤´ç©ºé—´å¸ƒå±€ï¼ˆ3Dï¼‰ï¼Œç”¨äºåˆæ­¥æ£€æŸ¥æ•°æ®è´¨é‡ä¸é€šé“åˆ†å¸ƒã€‚ 6.2 é¢„å¤„ç†ï¼ˆPreprocessingï¼‰ 6.2.1 è½¬æ¢ã€è´¨é‡æ§åˆ¶ä¸è¡€çº¢è›‹ç™½è®¡ç®— åœ¨ Convert + QC + Hb é¡µé¢ä¸­ï¼Œç³»ç»Ÿä¾æ¬¡æ‰§è¡Œï¼š å…‰å¼º --&gt; å…‰å¯†åº¦ï¼ˆOptical Densityï¼‰è½¬æ¢ åŸºäºæºâ€“æ¢æµ‹å™¨è·ç¦»ä¸ SCIï¼ˆScalp Coupling Indexï¼‰çš„è´¨é‡æ§åˆ¶ åŸºäº Beerâ€“Lambert å®šå¾‹è®¡ç®—è¡€çº¢è›‹ç™½æµ“åº¦å˜åŒ–ï¼ˆHbO / HbRï¼‰ å¤„ç†è¿‡ç¨‹ä¸­å¯æŸ¥çœ‹ SCI åˆ†å¸ƒç›´æ–¹å›¾ä¸è¡€çº¢è›‹ç™½ä¿¡å·ï¼Œä»¥è¾…åŠ©è¯„ä¼°é€šé“è´¨é‡ã€‚ 6.2.2 Filter + Epoch è¯¥æ¨¡å—ç”¨äºå¯¹ fNIRS è¡€çº¢è›‹ç™½ä¿¡å·è¿›è¡Œå¸¦é€šæ»¤æ³¢ï¼Œä»¥æŠ‘åˆ¶ä½é¢‘æ¼‚ç§»ä¸é«˜é¢‘ç”Ÿç†å™ªå£°ï¼Œä¿ç•™ä¸ä»»åŠ¡ç›¸å…³çš„è¡€æ°§åŠ¨åŠ›å­¦å˜åŒ–ã€‚ ä½é¢‘æˆªæ­¢ï¼ˆLow frequencyï¼‰ï¼šç”¨äºå»é™¤ç¼“æ…¢åŸºçº¿æ¼‚ç§»ï¼ˆå¦‚ä»ªå™¨æ¼‚ç§»ï¼‰ é«˜é¢‘æˆªæ­¢ï¼ˆHigh frequencyï¼‰ï¼šç”¨äºæŠ‘åˆ¶å¿ƒç‡ã€å‘¼å¸ç­‰é«˜é¢‘ç”Ÿç†å™ªå£° æ»¤æ³¢å®Œæˆåï¼Œå¯é€šè¿‡ View Epoch/Events æŒ‰é’®æŸ¥çœ‹äº‹ä»¶æ ‡è®°åœ¨æ—¶é—´è½´ä¸Šçš„åˆ†å¸ƒï¼Œç”¨äºç¡®è®¤äº‹ä»¶ä¸ä¿¡å·æ—¶åºçš„ä¸€è‡´æ€§ã€‚ åœ¨ç¡®è®¤å‚æ•°è®¾ç½®åï¼Œç‚¹å‡» Run æŒ‰é’®å³å¯æ‰§è¡Œæ»¤æ³¢æ“ä½œï¼Œç»“æœå°†ç”¨äºåç»­çš„äº‹ä»¶åˆ‡åˆ†ä¸ç‰¹å¾æå–æµç¨‹ã€‚ 6.3 ç‰¹å¾æå–ï¼ˆFeature Extractionï¼‰ 6.3.1 Epoch å¯è§†åŒ–ï¼ˆEpoch Visualizationï¼‰ åœ¨ Epoch Visualization é¡µé¢ä¸­ï¼Œå¯æ„å»º epochs ï¼Œå¹¶å¯¹epochsè¿›è¡Œæ£€æŸ¥ä¸å±•ç¤ºï¼š æ”¯æŒé€‰æ‹©è¡€çº¢è›‹ç™½ç±»å‹ï¼ˆHbOæˆ–HbRï¼‰ æä¾›Evokeæ—¶ç¨‹æ›²çº¿ã€ epoch çƒ­å›¾ï¼ˆepoch Imageï¼‰ä¸è”åˆè§†å›¾ï¼ˆJoint plotï¼‰ æ˜¾ç¤ºåŸºçº¿ä½ç½®ä¸ä»»åŠ¡ç›¸å…³å“åº”å˜åŒ– è¯¥æ­¥éª¤æœ‰åŠ©äºå¿«é€Ÿè¯„ä¼°ä»»åŠ¡è¯±å‘çš„è¡€æ°§åŠ¨åŠ›å­¦å“åº”ç‰¹å¾ã€‚ 6.3.2 ç‰¹å¾æå–ï¼šFeature Extraction åœ¨ Feature Extraction é¡µé¢ä¸­ï¼Œå¯ä» epochs ä¸­æå–å¸¸ç”¨ fNIRS ç‰¹å¾ï¼š æå–ç‰¹å¾åŒ…æ‹¬ï¼š å‡å€¼ï¼ˆmeanï¼‰ æ ‡å‡†å·®ï¼ˆstdï¼‰ å³°å€¼ï¼ˆpeakï¼‰ æ›²çº¿ä¸‹é¢ç§¯ï¼ˆAUCï¼‰ ä¸Šå‡æ–œç‡ï¼ˆslopeï¼‰ å³°å€¼æ—¶é—´ï¼ˆTTPï¼‰ ç‰¹å¾ç»“æœä»¥è¡¨æ ¼å½¢å¼å±•ç¤ºï¼Œå¹¶å¯å¯¼å‡ºä¸º CSV æ–‡ä»¶ï¼Œç”¨äºåç»­ç»Ÿè®¡åˆ†ææˆ–æœºå™¨å­¦ä¹ å»ºæ¨¡ã€‚ 6.4 æ•°æ®ä¿å­˜ï¼ˆSaveï¼‰ é¢„å¤„ç†åŠç‰¹å¾æå–å®Œæˆåï¼Œå¯å°†ç»“æœæ•°æ®ä¿å­˜åˆ°æœ¬åœ°ã€‚ä¿å­˜æ“ä½œä¸ä¼šä¿®æ”¹åŸå§‹æ•°æ®æ–‡ä»¶ï¼Œç¡®ä¿æ•°æ®å®‰å…¨ä¸å¯è¿½æº¯æ€§ã€‚ 7. sEMGæ¨¡å—ä½¿ç”¨è¯´æ˜ å¾…æ›´æ–°â€¦â€¦ 8. å¸¸è§é—®é¢˜ï¼ˆFAQï¼‰ Q1ï¼šåŒå‡»è½¯ä»¶æ²¡æœ‰ååº” / ä¸€é—ªè€Œè¿‡ è§£å†³æ–¹æ³•ï¼š ç¡®è®¤æ“ä½œç³»ç»Ÿä¸º 64 ä½ Windows å®‰è£… Microsoft Visual C++ Redistributable 2015â€“2022ï¼ˆx64ï¼‰ ç¡®ä¿æœªåˆ é™¤ _internal æ–‡ä»¶å¤¹ Q2ï¼šè½¯ä»¶æç¤ºâ€œæŸæŸåº“æœªå®‰è£…â€ è¿™æ˜¯è½¯ä»¶å†…éƒ¨ä¾èµ–é—®é¢˜ï¼Œå¹¶éç”¨æˆ·æ“ä½œé”™è¯¯ã€‚ è§£å†³æ–¹æ³•ï¼š è¯·è”ç³»è½¯ä»¶å¼€å‘è€…è·å–æ›´æ–°ç‰ˆæœ¬ ä¸éœ€è¦ã€ä¹Ÿæ— æ³•åœ¨ exe ä¸­æ‰§è¡Œ pip install Q3ï¼šå¤„ç†å¤§æ–‡ä»¶æ—¶è¿è¡Œè¾ƒæ…¢ å±äºæ­£å¸¸ç°è±¡ å»ºè®®ï¼š ä½¿ç”¨æ€§èƒ½æ›´é«˜çš„è®¡ç®—æœº é¿å…åŒæ—¶è¿è¡Œå¤§é‡ç¨‹åº 9. æ³¨æ„äº‹é¡¹ä¸å·²çŸ¥é™åˆ¶ å½“å‰ç‰ˆæœ¬ä¸»è¦é¢å‘å•æ–‡ä»¶äº¤äº’å¼å¤„ç† æš‚ä¸æ”¯æŒæ‰¹é‡è‡ªåŠ¨åŒ–å¤„ç† æš‚ä¸æ”¯æŒ Linux / macOS ç³»ç»Ÿ 10. ç‰ˆæœ¬ä¿¡æ¯ä¸è”ç³»æ–¹å¼ è½¯ä»¶åç§°ï¼šNeuroSignal Preprocessor å½“å‰ç‰ˆæœ¬ï¼šv1.0.0 å‘å¸ƒæ—¥æœŸï¼š2025-12-31 å¦‚æœ‰é—®é¢˜æˆ–å»ºè®®ï¼Œè¯·è”ç³»å¼€å‘è€…ã€‚é‚®ç®±ï¼šwsh_cathy@163.com Â© 2025 NeuroSignal Preprocessor","categories":[{"name":"Signal processing","slug":"Signal-processing","permalink":"https://weisihong9.github.io/categories/Signal-processing/"}],"tags":[{"name":"EEG_fNIRS_EMG","slug":"EEG-fNIRS-EMG","permalink":"https://weisihong9.github.io/tags/EEG-fNIRS-EMG/"}]},{"title":"MNE_EEG","slug":"MNE_EEG","date":"2024-05-14T16:00:00.000Z","updated":"2024-05-16T01:30:04.417Z","comments":true,"path":"2024/05/15/MNE_EEG/","link":"","permalink":"https://weisihong9.github.io/2024/05/15/MNE_EEG/","excerpt":"","text":"ç›®çš„ï¼šä»‹ç»ç”¨pythonçš„MNEé¢„å¤„ç†EEGæ•°æ®ï¼Œå¹¶ç»˜åˆ¶ERSP EEG analysis with MNE-Python This tutorial covers the basic EEG pipeline for event-related analysis: loading data, preprocessing, epoching, averaging, plotting, time-frequency analysis, and estimating cortical activity from sensor data. ä¸€ã€å®éªŒèŒƒå¼ äºŒã€é¢„å¤„ç† 1. åŠ è½½package 1234567891011121314import osimport mneimport numpy as npimport pandas as pdimport matplotlib.pyplot as pltfrom mne.preprocessing import EOGRegressionfrom scipy.ndimage import gaussian_filter1dfrom mne.time_frequency import tfr_morletimport warningswarnings.filterwarnings(&#x27;ignore&#x27;)warnings.simplefilter(&#x27;ignore&#x27;)%matplotlib qt 2. åŠ è½½æ•°æ® 1234path = &#x27;.\\\\EEG\\\\set\\\\&#x27;fileName = &quot;clench_right&quot;raw = mne.io.read_raw_eeglab(path + fileName + &#x27;.set&#x27;) raw.info 3. è®¾ç½®çœ¼ç”µã€å¿ƒç”µã€å»é™¤ä¸è¦çš„channel è¿™é‡Œæ ¹æ®ä½ è‡ªå·±çš„ç”µææ¥è®¾å®š 123pd.DataFrame(raw.ch_names) # æŸ¥çœ‹é€šé“åç§°raw.set_channel_types(&#123;&#x27;HEOG&#x27;:&#x27;eog&#x27;, &#x27;VEOG&#x27;:&#x27;eog&#x27;&#125;) # 32å¯¼è”ï¼ŒVEOå‚ç›´çœ¼ç”µï¼ŒHEOæ°´å¹³çœ¼ç”µï¼ŒECGå¿ƒç”µ # raw.pick(picks=&#x27;all&#x27;, exclude=[&#x27;TRIGGER&#x27;, &#x27;ECG&#x27;, &#x27;EMG&#x27;]) # å»é™¤æ— ç”¨ç”µæ 4. æŸ¥çœ‹rawæ•°æ®æ³¢å½¢ï¼Œå…³æ³¨ä¿¡å™ªæ¯”ï¼Œè¯¥æ•°æ®æ˜¯å¦å¯ç”¨ã€åå¯¼æ’å€¼ã€‘ 4.0 æŸ¥çœ‹rawæ³¢å½¢ï¼Œç»˜åˆ¶psd 1234raw.plot(start=10, duration=1) # ä»10så¼€å§‹ï¼Œçª—å£æ˜¾ç¤ºæ—¶é•¿1splt.show()raw.plot_psd(fmin=0, fmax=250)plt.show() 4.1 æŒ‘é€‰åå¯¼ æŠŠè®¤ä¸ºæ˜¯åå¯¼çš„ï¼Œé¼ æ ‡å·¦é”®ç‚¹å‡»ä¸€ä¸‹å˜ç°å³å¯ 12raw.plot(start=10, duration=1, title=&#x27;è¯·é€‰æ‹©éœ€è¦æ’å€¼çš„åå¯¼&#x27;) # ä»20så¼€å§‹ï¼Œçª—å£æ˜¾ç¤ºæ—¶é•¿1splt.show() 4.2 æ’å€¼åå¯¼ 12raw.load_data() # é»˜è®¤æƒ…å†µä¸‹ï¼ŒMNEä¸ä¼šå°†æ•°æ®åŠ è½½åˆ°ä¸»å†…å­˜ä»¥èŠ‚çº¦èµ„æºã€‚æ’å€¼éœ€è¦åŠ è½½åŸå§‹æ•°æ®ã€‚åœ¨æ„é€ å‡½æ•°æˆ–raw.load_data()ä¸­ä½¿ç”¨preload=Trueï¼ˆæˆ–å­—ç¬¦ä¸²ï¼‰ã€‚raw.interpolate_bads() 5. å¸¦é€šæ»¤æ³¢ï¼š2 ~ 40 * 123raw_filter = raw.copy()raw_filter.load_data()raw_filter.filter(l_freq=2, h_freq=40, n_jobs=1) 6. é‡å‚è€ƒ * 1raw_ref = raw_filter.copy() 6.1 åŒä¾§ä¹³çªå‚è€ƒ å› ä¸ºæˆ‘åœ¨é‡‡é›†æ•°æ®æ—¶ï¼Œç”¨çš„å‚è€ƒç”µææ˜¯M2ï¼Œè¿™é‡Œå†æ¬¡é€‰æ‹©åŒä¾§ä¹³çªå‚è€ƒçš„åŸç†å‚è€ƒè¿™ç¯‡æ–‡ç«  123456&#x27;&#x27;&#x27; 1. æ·»åŠ  M2ï¼Œå€¼ä¸º0 &#x27;&#x27;&#x27;# add new reference channel (all zero) æ·»åŠ ä¸€ä¸ªæ–°çš„å‚è€ƒç”µæï¼Œå€¼ä¸º0ï¼Œè¿™æ ·é€‰æ‹©M1ï¼ŒM2é‡å‚è€ƒï¼Œå°±ç›¸å½“äº 1/2 M1å•¦raw_new_ref = mne.add_reference_channels(raw_ref, ref_channels=[&quot;M2&quot;])# raw_new_ref.plot()&#x27;&#x27;&#x27; 2. åŒä¾§ä¹³çªé‡å‚è€ƒ&#x27;&#x27;&#x27; raw_new_ref.set_eeg_reference(ref_channels=[&#x27;M1&#x27;, &#x27;M2&#x27;]) 6.2 å¹³å‡å‚è€ƒ å¹³å‡å‚è€ƒçš„è¯ï¼Œä¸€èˆ¬æ”¾åˆ°ICAä¹‹å 1raw_ref.set_eeg_reference(ref_channels=&#x27;average&#x27;) 7. ICAå»çœ¼ç”µ * 7.1 é€‰å–éœ€è¦å»é™¤çš„ICAæˆåˆ† 12345678&#x27;&#x27;&#x27; 1. ICAï¼Œç‹¬ç«‹æˆåˆ†åˆ†æå»é™¤çœ¼ç”µå’Œå¿ƒç”µä¼ªè¿¹&#x27;&#x27;&#x27;ica = mne.preprocessing.ICA(n_components=20, max_iter=800) # å®šä¹‰ä¸€ä¸ªICAæ–¹æ³•ica.fit(raw_new_ref) # è®­ç»ƒICAæ¨¡å‹raw_new_ref.load_data()ica.plot_sources(raw_new_ref, show_scrollbars=True, title=&#x27;è¯·é€‰æ‹©éœ€è¦å»é™¤çš„æˆåˆ†&#x27;) ica.plot_components()&#x27;&#x27;&#x27; 2. å¯¹ICAä¹‹åçš„æˆåˆ†è¿›è¡Œç»˜åˆ¶ï¼Œè·Ÿå‰é¢é€‰æ‹©åå¯¼æ–¹æ³•ä¸€è‡´ &#x27;&#x27;&#x27; plt.show() 7.2 ICAæˆåˆ†å‰”é™¤ 123456789&#x27;&#x27;&#x27; 3. æŸ¥çœ‹é€‰æ‹©å»é™¤çš„æˆåˆ†ä¸ªæ•° &#x27;&#x27;&#x27; print(ica)raw_ICA = raw_new_ref.copy()&#x27;&#x27;&#x27; 4. å»é™¤åˆšåˆšé€‰æ‹©çš„ä¼ªè¿¹æˆåˆ† &#x27;&#x27;&#x27;raw_ICA = ica.apply(raw_ICA) &#x27;&#x27;&#x27; 5. ICAå»é™¤å‰åæ³¢å½¢æ¯”è¾ƒ&#x27;&#x27;&#x27; raw_new_ref.plot(start=1, duration=5, title=&#x27;ICAå¤„ç†å‰ï¼Œå¦‚æ— è¯¯è¯·å…³é—­çª—å£&#x27;)raw_ICA.plot(start=1, duration=5, title=&#x27;ICAå¤„ç†åï¼Œå¦‚æ— è¯¯è¯·å…³é—­çª—å£&#x27;)plt.show() 8. é€šé“å®šä½ * è¿™ä¸€æ­¥ä¸€èˆ¬ä¸éœ€è¦ï¼Œåªä¸è¿‡æ˜¯å› ä¸ºæˆ‘çš„ç”µæé‡æ–°å¸ƒç½®äº†ï¼Œæ‰€ä»¥å¾—é‡æ–°å®šä½ è‡ªå®šä¹‰ç”µæä½ç½®ï¼Œéœ€è¦è‡ªå®šä¹‰ç”µæå¸ƒå±€æ–‡ä»¶å¯¹æ•°æ®è¿›è¡Œé€šé“å®šä½å¯ä»¥æŸ¥çœ‹è¿™ç¯‡æ–‡ç« ã€‚ 12345678910111213141516171819202122232425262728293031# æŸ¥çœ‹é€šé“åç§°raw_ICA_rename = raw_ICA.copy()raw_ICA_rename.pick(picks=&#x27;all&#x27;, exclude=[&#x27;M1&#x27;, &#x27;M2&#x27;,&#x27;HEOG&#x27;,&#x27;VEOG&#x27;])# pd.DataFrame(raw_ICA_rename.ch_names)raw_chName = raw_ICA_rename.ch_namesrename_chName = &#123;&#125;for ch in raw_chName: if ch == &#x27;T7&#x27;: rename_chName[ch] = &#x27;C5&#x27; elif ch == &#x27;TP7&#x27;: rename_chName[ch] = &#x27;CP5&#x27; elif ch == &#x27;T8&#x27;: rename_chName[ch] = &#x27;C6&#x27; elif ch == &#x27;TP8&#x27;: rename_chName[ch] = &#x27;CP6&#x27; else: rename_chName[ch] = ch&#x27;&#x27;&#x27; 1. é€šé“é‡å‘½å &#x27;&#x27;&#x27;raw_ICA_rename.rename_channels(rename_chName)&#x27;&#x27;&#x27; 2. åŠ è½½å®šä½æ–‡ä»¶&#x27;&#x27;&#x27;myStardart1020 = pd.read_excel(&#x27;sensor_dataFrame_32.xlsx&#x27;, index_col=0) ch_names = np.array(myStardart1020.index) # ç”µæåç§°position = np.array(myStardart1020) # ç”µæåæ ‡ä½ç½®sensorPosition = dict(zip(ch_names, position)) # åˆ¶å®šä¸ºå­—å…¸çš„å½¢å¼montage = mne.channels.make_dig_montage(ch_pos=sensorPosition)&#x27;&#x27;&#x27; 3. é€šé“å®šä½ &#x27;&#x27;&#x27;raw_ICA_rename.set_montage(montage) 9. ä¿å­˜é¢„å¤„ç†åçš„æ•°æ® 12sub = &#x27;sub1_&#x27;raw_ICA_rename.save(&quot;.//1_preProcessData//&quot;+ sub +fileName+&quot;_M1reRef_preP-eeg.fif&quot;, overwrite = False) ä¸‰ã€æå–epochï¼Œevoked * 1. ç»˜åˆ¶eventså›¾ 1234events, event_dict = mne.events_from_annotations(raw_ICA_rename)event_id = &#123;&#x27;Fix&#x27;:event_dict[&#x27;1&#x27;], &#x27;task&#x27;:event_dict[&#x27;3&#x27;],&#x27;Rest&#x27;:event_dict[&#x27;5&#x27;]&#125; # markerç±»å‹ç”±è‡ªå·±çš„èŒƒå¼ä»»åŠ¡å†³å®šplt.rcParams[&#x27;figure.figsize&#x27;]=(7, 5)mne.viz.plot_events(events, event_id=event_id, sfreq=raw.info[&quot;sfreq&quot;]) 2. æ ¹æ®markeræå–epoch 1234567891011121314events = mne.events_from_annotations(raw_ICA_rename)event_dic = &#123;&#x27;Fix&#x27;:events[1][&#x27;1&#x27;], &#x27;task&#x27;:events[1][&#x27;3&#x27;], &#x27;Rest&#x27;:events[1][&#x27;5&#x27;]&#125; # reject_criteria = dict(eeg=100e-6) # å¹…åº¦å¤§äº100å¾®å¹…çš„ä¸è¦ï¼Œè¿™ä¸ªå¯è¦å¯ä¸è¦ï¼Œå³æŒ¯å¹…è¿‡å¤§å°±å»é™¤epochs = mne.Epochs(raw_ICA_rename, events[0], event_id=event_dic, preload=True, tmax=20, tmin=-10, # åˆºæ¿€å‰10sï¼Œåˆºæ¿€å20s # reject=reject_criteria, baseline = None, # è¦åšERSPï¼Œæå–epochæ—¶ä¸éœ€è¦åŸºçº¿çŸ«æ­£ baseline= (-2,0) ) epochs 3. ç›®è§†å¹¶æ‰‹åŠ¨å»é™¤ä¼ªè¿¹ä¾ç„¶ä¸¥é‡çš„epoch 123task_epochs = epochs[&#x27;task&#x27;]task_epochs.plot(title=&quot;è¯·ç›®è§†æŒ‘å‡ºåepochs&quot;)plt.show() 4. ç»˜åˆ¶evokedæ—¶åŸŸæ³¢å½¢ 123task_evoked = task_epochs.average()task_evoked.plot(picks=[&#x27;C3&#x27;,&#x27;C4&#x27;], xlim=(-2,2))plt.show() 5. ç»˜åˆ¶evokedçš„psd 123456789task_evoked.crop(0,12).plot_psd(fmin=2, fmax=30, picks=[&#x27;C3&#x27;, &#x27;C4&#x27;], # method = &#x27;welch&#x27;, xscale=&#x27;linear&#x27;, dB=False, estimate=&#x27;amplitude&#x27;, )plt.title(sub + fileName) 6. ç»˜åˆ¶evokedæŸä¸€æ—¶åˆ»çš„è„‘åœ°å½¢å›¾ åªèƒ½é€‰æ‹©æŸä¸€æ—¶åˆ» å‚è€ƒï¼šhttps://mne.tools/dev/auto_examples/visualization/evoked_topomap.html#sphx-glr-auto-examples-visualization-evoked-topomap-py 12times = np.arange(-2, 14, 2)task_evoked.plot_topomap(times, ch_type=&quot;eeg&quot;, ncols=4, nrows=&quot;auto&quot;) å››. ç»˜åˆ¶ERSP * è¦è®¡ç®—ERSPï¼Œæå–epochæ—¶ä¸éœ€è¦åŸºçº¿çŸ«æ­£ã€‚ ERSPï¼šåæ˜ äº†ä¿¡å·ä¸­ä¸åŒé¢‘ç‡çš„åŠŸç‡ç›¸å¯¹äºç‰¹å®šæ—¶é—´ç‚¹ï¼ˆä¾‹å¦‚ä¿¡å·å‡ºç°ï¼‰çš„å˜åŒ–ç¨‹åº¦ã€‚ äº‹ä»¶ç›¸å…³åŒæ­¥åŒ–/å»åŒæ­¥åŒ–ï¼ševent-related synchronization / desynchronization ï¼ˆERS/ERDï¼‰ ERD å¯¹åº”äºç‰¹å®šé¢‘å¸¦å†…çš„åŠŸç‡ç›¸å¯¹äºåŸºçº¿çš„é™ä½ã€‚ç±»ä¼¼åœ°ï¼ŒERS å¯¹åº”äºåŠŸç‡çš„å¢åŠ ã€‚ ERDS å›¾æ˜¯ ERD/ERS åœ¨ä¸€å®šé¢‘ç‡èŒƒå›´å†…çš„æ—¶é—´/é¢‘ç‡è¡¨ç¤ºå½¢å¼ã€‚ ERDS åœ°å›¾ä¹Ÿç§°ä¸º ERSPï¼ˆäº‹ä»¶ç›¸å…³é¢‘è°±æ‰°åŠ¨ï¼ševent-related spectral perturbationï¼Œ ERSPï¼‰ã€‚ å‚è€ƒï¼šhttps://zh-1-peng.gitbook.io/eeg-analysis-note/ersp 1. å®šä¹‰å°æ³¢å‡½æ•°è®¡ç®—æ—¶é¢‘è°± å‚è€ƒï¼šhttps://mne.tools/stable/auto_tutorials/time-freq/20_sensors_time_frequency.html#sphx-glr-auto-tutorials-time-freq-20-sensors-time-frequency-py 1234567891011121314151617from mne.time_frequency import tfr_morletfreqs = np.logspace(*np.log10([2, 40]), num=80)n_cycles = freqs / 2.0 # different number of cycle per frequency# 1. å®šä¹‰å‡½æ•°def getPSD(dataEpochs): power1, itc = tfr_morlet( dataEpochs, freqs=freqs, n_cycles=n_cycles, use_fft=True, return_itc=True, decim=3, n_jobs=1,) return power1, itc# 2. è®¡ç®—task_power, itc = getPSD(task_epochs) 2. ç»˜åˆ¶å•é€šé“ERSP modeï¼šâ€˜meanâ€™ | â€˜ratioâ€™ | â€˜logratioâ€™ | â€˜percentâ€™ | â€˜zscoreâ€™ | â€˜zlogratioâ€™ Perform baseline correction by subtracting the mean of baseline values (â€˜meanâ€™) dividing by the mean of baseline values (â€˜ratioâ€™) dividing by the mean of baseline values and taking the log (â€˜logratioâ€™) subtracting the mean of baseline values followed by dividing by the mean of baseline values (â€˜percentâ€™) subtracting the mean of baseline values and dividing by the standard deviation of baseline values (â€˜zscoreâ€™) dividing by the mean of baseline values, taking the log, and dividing by the standard deviation of log baseline values (â€˜zlogratioâ€™) 1234567891011121314151617181920def plotTF(taskPower, tmin1, tmax1, ch, fn): # chï¼šéœ€è¦ç»˜åˆ¶çš„å¯¼è”åç§° # ç»˜åˆ¶æ—¶é¢‘å›¾ taskPower.plot( picks = task_power.ch_names.index(ch), baseline=(-7, -3), # è¿™é‡Œæˆ‘é€‰æ‹©åŸºçº¿æ˜¯ï¼ˆ-7~-3ï¼‰ï¼Œåé¢çš„poweréƒ½å‡å»åŸºçº¿çš„å‡å€¼ã€‚è¡¨ç¤ºï¼šæ‰€æœ‰ç‰¹å®šé¢‘å¸¦å†…çš„åŠŸç‡ç›¸å¯¹äºåŸºçº¿ï¼ˆ-7ï¼Œ-3ï¼‰çš„å˜åŒ–ç¨‹åº¦ mode=&quot;percent&quot;, # å…·ä½“å«ä¹‰å‚è€ƒä¸Šé¢çš„è§£é‡Š tmin=tmin1, tmax=tmax1, vmin=-1, vmax=1, show=False, colorbar=True, # cmap=&#x27;jet&#x27;, ) plt.ylim([0, 40]) plt.suptitle(ch) plt.savefig(&quot;.//1_preProcessData//TFA//&quot;+fn+ch, dpi=600) # ä¿å­˜ç»˜åˆ¶çš„TF# ç»˜åˆ¶fn = sub+ fileNameplotTF(task_power, -10, 20, &#x27;C3&#x27;, fn) å¯ä»¥å‘ç°åœ¨ä»»åŠ¡æ—¶æœŸï¼Œ0~8så†…ï¼Œalphaé¢‘æ®µçš„èƒ½é‡ç›¸è¾ƒäºåŸºçº¿æ˜æ˜¾ä¸‹é™ï¼Œè¿™æ˜¯æ˜æ˜¾çš„ERDç°è±¡ã€‚ 3. ç»˜åˆ¶æ‰€æœ‰é€šé“çš„ERSP 1task_power.plot_topo(baseline=(-7, -3), mode=&#x27;percent&#x27;, vmin=-1, vmax=1, title=&quot;Average power&quot;) # mode=&quot;logratio&quot; 4. ä¿å­˜è®¡ç®—çš„æ—¶é¢‘è°± 1234import picklewith open(&#x27;task_power.pkl&#x27;, &#x27;wb&#x27;) as f: pickle.dump(task_power, f) 5. åŠ è½½ä¿å­˜å¥½çš„æ—¶é¢‘è°± 12with open(&#x27;task_power.pkl&#x27;, &#x27;rb&#x27;) as f: task_power = pickle.load(f) 6. æ—¶é—´è¿›ç¨‹ä¸Šç‰¹å®šé¢‘æ®µpowerçš„å˜åŒ– 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647def getPowerDataFrameTime(power_task, ch_pair): freqs = np.arange(2, 40) # frequencies from 2-35Hz # vmin, vmax = -1, 1.5 # set min and max ERDS values in plot baseline = (-7, -3) # baseline interval (in s) tmin, tmax = -7, 20 &#x27;&#x27;&#x27; ERSDï¼š percentï¼š å‡å»åŸºçº¿å€¼çš„å¹³å‡å€¼ï¼Œå†é™¤ä»¥åŸºçº¿å€¼çš„å¹³å‡å€¼ï¼ˆ&quot;ç™¾åˆ†æ¯”ï¼‰ &#x27;&#x27;&#x27; power_task.crop(tmin, tmax).apply_baseline(baseline, mode=&quot;percent&quot;) &#x27;&#x27;&#x27; 0. å­—å…¸å½¢å¼ &#x27;&#x27;&#x27; df = power_task.to_data_frame(time_format=None, long_format=True) &#x27;&#x27;&#x27; 1. é€‰æ‹©æ„Ÿå…´è¶£çš„é€šé“ &#x27;&#x27;&#x27; new_categories = ch_pair df = df[df.channel.isin(new_categories)] df[&quot;channel&quot;] = df[&quot;channel&quot;].cat.remove_unused_categories() df[&quot;channel&quot;] = df[&quot;channel&quot;].cat.reorder_categories(new_categories, ordered=True) &#x27;&#x27;&#x27; 2. é€‰æ‹©æ„Ÿå…´è¶£çš„é¢‘æ®µ &#x27;&#x27;&#x27; freq_bounds = &#123;&quot;_&quot;: 0, &quot;delta&quot;: 4, &quot;theta&quot;: 8, &quot;alpha&quot;: 13, &quot;beta&quot;: 30, &quot;gamma&quot;:40&#125; df[&quot;band&quot;] = pd.cut( df[&quot;freq&quot;], list(freq_bounds.values()), labels=list(freq_bounds)[1:] ) freq_bands_of_interest = [&quot;alpha&quot;,&quot;beta&quot;] # &quot;delta&quot;, &quot;theta&quot;,, &quot;beta&quot;, &quot;gamma&quot; df = df[df.band.isin(freq_bands_of_interest)] df[&quot;band&quot;] = df[&quot;band&quot;].cat.remove_unused_categories() return df# 1. é€‰æ‹©æ„Ÿå…´è¶£çš„é€šé“ch_pairs = [&#x27;C3&#x27;, &#x27;CZ&#x27;, &#x27;C4&#x27;]# 2. è·å–ç»Ÿè®¡çš„DataFrametask_power_time = getPowerDataFrameTime(task_power.copy(), ch_pairs)# 3. ç»˜å›¾g = sns.FacetGrid(task_power_time, row=&quot;band&quot;, margin_titles=True)g.map(sns.lineplot, &quot;time&quot;, &quot;value&quot;, &quot;channel&quot;, n_boot=10, linewidth=2)axline_kw = dict(color=&quot;black&quot;, linestyle=&quot;dashed&quot;, linewidth=0.5, alpha=0.5)g.map(plt.axhline, y=0, **axline_kw)g.map(plt.axvline, x=0, **axline_kw)g.refline(x=0, color=&#x27;red&#x27;)g.refline(y=0, color=&#x27;red&#x27;)g.set(ylim=(-0.9, 0.9))g.set_axis_labels(&quot;Time (s)&quot;, &quot;ERDS&quot;)g.set_titles(col_template=&quot;&#123;col_name&#125;&quot;, row_template=&quot;&#123;row_name&#125;&quot;)g.add_legend(ncol=3, loc=&quot;lower center&quot;)g.fig.subplots_adjust(left=0.1, right=0.9, top=0.9, bottom=0.08) å¦ä¸€ç§ç”»æ³• 12345678910111213g = sns.FacetGrid(task_power_time, row=&quot;band&quot;, col=&quot;channel&quot;, margin_titles=True)g.map(sns.lineplot, &quot;time&quot;, &quot;value&quot;, n_boot=10, linewidth=2)axline_kw = dict(color=&quot;black&quot;, linestyle=&quot;dashed&quot;, linewidth=0.5, alpha=0.5)g.map(plt.axhline, y=0, **axline_kw)g.map(plt.axvline, x=0, **axline_kw)g.refline(x=0, color=&#x27;red&#x27;)g.refline(y=0, color=&#x27;red&#x27;)g.set(ylim=(-0.9, 0.9))g.set_axis_labels(&quot;Time (s)&quot;, &quot;ERDS&quot;)g.set_titles(col_template=&quot;&#123;col_name&#125;&quot;, row_template=&quot;&#123;row_name&#125;&quot;)g.add_legend(ncol=2, loc=&quot;lower center&quot;)g.fig.subplots_adjust(left=0.1, right=0.9, top=0.9, bottom=0.08) 7. é¢‘æ®µè¿›ç¨‹ä¸Šç‰¹å®šæ—¶é—´æ®µpowerçš„å˜åŒ– 12345678910111213141516171819202122232425262728293031323334353637383940414243444546def getPowerDataFrameBand(power_task, ch_pair): freqs = np.arange(2, 40) # frequencies from 2-35Hz # vmin, vmax = -1, 1.5 # set min and max ERDS values in plot baseline = (-7, -3) # baseline interval (in s) tmin, tmax = -7, 20 &#x27;&#x27;&#x27; åŸºçº¿ &#x27;&#x27;&#x27; power_task.crop(tmin, tmax).apply_baseline(baseline, mode=&quot;percent&quot;) &#x27;&#x27;&#x27; 0. å­—å…¸å½¢å¼ &#x27;&#x27;&#x27; df = power_task.to_data_frame(time_format=None, long_format=True) &#x27;&#x27;&#x27; 1. é€‰æ‹©æ„Ÿå…´è¶£çš„é€šé“ &#x27;&#x27;&#x27; new_categories = ch_pair df = df[df.channel.isin(new_categories)] df[&quot;channel&quot;] = df[&quot;channel&quot;].cat.remove_unused_categories() df[&quot;channel&quot;] = df[&quot;channel&quot;].cat.reorder_categories(new_categories, ordered=True) &#x27;&#x27;&#x27; 2. é€‰æ‹©æ„Ÿå…´è¶£çš„æ—¶é—´æ®µ &#x27;&#x27;&#x27; df_mean = (df.query(&quot;time &gt; 1 &amp; time &lt; 7&quot;) .groupby([&quot;channel&quot;,&quot;freq&quot;], observed=False)[[&quot;value&quot;]] .mean() .reset_index() ) return df_mean# è®¡ç®—ch_pairs = [&#x27;C3&#x27;, &#x27;C4&#x27;]task_power_band = getPowerDataFrameBand(task_power.copy(), ch_pairs)task_power_band# ç»˜åˆ¶g = sns.FacetGrid(task_power_band, margin_titles=True)g.map(sns.lineplot, &quot;freq&quot;, &quot;value&quot;, &quot;channel&quot;,n_boot=10, linewidth=2)axline_kw = dict(color=&quot;black&quot;, linestyle=&quot;dashed&quot;, linewidth=0.5, alpha=0.5)g.map(plt.axhline, y=0, **axline_kw)g.map(plt.axvline, x=0, **axline_kw)g.refline(x=0, color=&#x27;red&#x27;)g.refline(y=0, color=&#x27;red&#x27;)# g.set(ylim=(None, 0.5))g.set_axis_labels(&quot;Frequency (Hz)&quot;, &quot;ERDS&quot;)g.set_titles(col_template=&quot;&#123;col_name&#125;&quot;, row_template=&quot;&#123;row_name&#125;&quot;)g.add_legend(ncol=3, loc=&quot;upper center&quot;)g.fig.subplots_adjust(left=0.1, right=0.9, top=0.9, bottom=0.08) 8. ç»˜åˆ¶ERSD Map å¯ä»¥é€‰æ‹©é¢‘æ®µå’Œæ—¶é—´åŒºé—´ 123456789101112131415161718192021def plotTopoMap(taskPower, tmin1, tmax1, fn): # topomap_args = dict(extrapolate=&quot;local&quot;) &#x27;&#x27;&#x27; 1. é€‰æ‹©æ„Ÿå…´è¶£çš„é¢‘æ®µ &#x27;&#x27;&#x27; plot_dict = dict(Alpha=dict(fmin=9, fmax=12)) &#x27;&#x27;&#x27; 2. é€‰æ‹©æ„Ÿå…´è¶£çš„æ—¶é—´åŒºé—´ï¼štmin1, tmax1 &#x27;&#x27;&#x27; topomap_kw = dict(tmin=tmin1, tmax=tmax1, baseline=(-7, -3), mode=&quot;percent&quot;, show=False) for (title, fmin_fmax) in plot_dict.items(): taskPower.plot_topomap(**fmin_fmax, # cmap=&#x27;Pastel1&#x27;, # vlim=(-0.7, 0.7), **topomap_kw, # **topomap_args ) plt.suptitle(str(tmin1) +&#x27;_&#x27;+ str(tmax1)+&#x27;s_8-11Hz&#x27;) plt.savefig(&quot;.//1_preProcessData//TopoMap//&quot;+fn, dpi=600) fn1 = sub + fileNameplotTopoMap(taskPower=task_power, tmin1=0, tmax1=7, fn=fn1) ä»¥ä¸Šå°±æ˜¯ä»EEGé¢„å¤„ç†åˆ°ç»˜åˆ¶ERSPçš„å…¨éƒ¨è¿‡ç¨‹ï¼Œè¿™é‡Œè€ƒè™‘äº†å¾ˆå¤šæƒ…å†µï¼Œæ­¥éª¤æœ‰ç‚¹å¤šï¼Œå¦‚æœæƒ³è¦ä¿®æ”¹ä½†ä¸çŸ¥é“æ€ä¹ˆæ”¹çš„å¯ä»¥ç»™æˆ‘ç•™è¨€å“¦ã€‚","categories":[{"name":"EEG","slug":"EEG","permalink":"https://weisihong9.github.io/categories/EEG/"},{"name":"ERSP","slug":"EEG/ERSP","permalink":"https://weisihong9.github.io/categories/EEG/ERSP/"}],"tags":[{"name":"ERSP","slug":"ERSP","permalink":"https://weisihong9.github.io/tags/ERSP/"}]},{"title":"BrainNetwork","slug":"BrainNetwork","date":"2023-11-23T16:00:00.000Z","updated":"2023-11-24T02:48:05.727Z","comments":true,"path":"2023/11/24/BrainNetwork/","link":"","permalink":"https://weisihong9.github.io/2023/11/24/BrainNetwork/","excerpt":"","text":"ç›®çš„ï¼šåˆ©ç”¨matlabå·¥å…·åŒ… BrainNet Viewer ç»˜åˆ¶è„‘ç½‘ç»œå›¾ 1. BrainNet Viewer çš„ä¸»è¦åŠŸèƒ½ è„‘ç½‘ç»œçš„å¤šè§†è§’æ˜¾ç¤º æ˜¾ç¤ºå¤šç§è„‘æ›²é¢ã€èŠ‚ç‚¹å’Œè¾¹æ„æˆçš„ä¸åŒç»„åˆ å¤šç§æ–¹å¼è°ƒèŠ‚ç‚¹ã€è¾¹çš„é¢œè‰²å’Œå¤§å° è‡ªå®šé˜ˆå€¼æ¥æå–ç›¸å…³çŸ©é˜µä¸­çš„è¾¹ä¿¡æ¯ å®ç°ä½“ç´ å›¾åƒåˆ°æ›²é¢çš„æ˜ å°„ å¯è¿›è¡Œæ”¾å¤§ã€ç¼©å°ã€æ—‹è½¬ç­‰äº¤äº’å¼æ“ä½œ æ”¯æŒjpgã€pngç­‰å¤šç§æ ¼å¼çš„è¾“å‡º 2. BrainNet Viewer çš„å®‰è£… å»å®˜ç½‘ä¸‹è½½BrianNet Viewerå·¥å…·åŒ…æ”¾åˆ°è‡ªå·±ç”µè„‘çš„æ–‡ä»¶å¤¹é‡Œã€‚ å› ä¸ºBrianNet Vieweræ˜¯åŸºäºMatlabçš„ï¼Œæ•…åªéœ€è¦åœ¨Matlabçš„è·¯å¾„é‡Œé¢æ·»åŠ BrianNet Viewerçš„æ–‡ä»¶è·¯å¾„å³å¯ã€‚ 3. BrainNet Viewer çš„ä½¿ç”¨ 1ï¼‰æ‰“å¼€Matlabï¼Œåœ¨å‘½ä»¤è¡Œçª—å£è¾“å…¥ï¼šBrainNet 2ï¼‰è¿›å…¥BrainNet Viewerç•Œé¢ 3ï¼‰BNç±»å‹ BrainNet Viewerå¯ä»¥äº§ç”Ÿå¤šç§ç»„åˆå›¾ï¼ˆå¦‚ä¸‹å›¾ï¼‰ï¼Œå› ä¸ºæˆ‘åšçš„æ˜¯EEGï¼Œæ‰€ä»¥å¸¸ç”¨çš„æ˜¯ç¬¬5ç§ï¼Œåé¢æˆ‘ä»¬ä¼šè¯¦ç»†ä»‹ç»æ­¤ç§å›¾çš„ç”»æ³•ï¼Œä¹Ÿç®€å•ä»‹ç»ç¬¬9ç§ã€‚ 4. è„‘ç½‘ç»œç»˜åˆ¶æµç¨‹ è¯»å…¥æ–‡ä»¶ è®¾ç½®ç»˜å›¾æ ¼å¼ è„‘ç½‘ç»œå›¾æ˜¾ç¤º ç»“æœå¯¼å‡º è°ƒæ•´node label 1ï¼‰è¯»å…¥æ–‡ä»¶ 1 è„‘æ›²é¢æ–‡ä»¶ï¼ˆSurface fileï¼‰ï¼šASCIIæ–‡ä»¶ï¼Œåç¼€åä¸ºâ€˜nvâ€™ï¼ŒåŒ…å«äº†è„‘æ›²é¢ä¸Šçš„é¡¶ç‚¹å’Œä¸‰è§’æ›²é¢ä¿¡æ¯ 2 èŠ‚ç‚¹æ–‡ä»¶ï¼ˆnode fileï¼‰ï¼šASCIIæ–‡ä»¶ï¼Œåç¼€åä¸ºâ€™nodeâ€™ï¼Œä¸ºnx6çš„çŸ©é˜µï¼ŒåŒ…å«äº†èŠ‚ç‚¹çš„åæ ‡ã€é¢œè‰²ã€å¤§å°å’Œæ ‡ç­¾ä¿¡æ¯ 3 è¾¹æ–‡ä»¶ï¼ˆedge fileï¼‰ï¼šASCIIæ–‡ä»¶ï¼Œåç¼€åä¸ºâ€˜edgeâ€™ï¼Œä¸ºnxnçŸ©é˜µï¼Œå³èŠ‚ç‚¹é—´çš„ç›¸å…³çŸ©é˜µ 4 ä¸‰ç»´å›¾åƒæ–‡ä»¶ï¼ˆvolume fileï¼‰ï¼šNIFTIæˆ–Analyzeæ ¼å¼ï¼Œåç¼€åä¸ºé…å¯¹çš„â€˜hdrâ€™å’Œâ€˜imgâ€™è¯¥æ–‡ä»¶ä»…ç”¨äºä½“ç´ åˆ°æ›²é¢çš„æ˜ å°„ç»˜åˆ¶ [x] File â€”&gt; Load File æ–‡ä»¶è¯´æ˜ aï¼‰Surface file aï¼‰Node file aï¼‰Edge file 2ï¼‰è®¾ç½®ç»˜å›¾æ ¼å¼ 1 å¸¦labelçš„å›¾ï¼šå‰é¢å¯¼å…¥æ–‡ä»¶æ·»åŠ å®Œè·¯å¾„ç‚¹å‡»â€˜okâ€™æŒ‰é’®ä¹‹åä¼šå‡ºç°å³å›¾çš„ç•Œé¢ï¼Œé€‰æ‹© Node --&gt; Label All --&gt; Colomap ç‚¹å‡»â€˜okâ€™å³å¯ç”»å‡ºè„‘ç½‘ç»œè¿æ¥å›¾ã€‚ 2 é€‰æ‹©Colomapç”»å‡ºæ¥çš„èŠ‚ç‚¹é¢œè‰²ä¼šæ ¹æ®ä½ nodeæ–‡ä»¶èŠ‚ç‚¹é¢œè‰²éƒ¨åˆ†æ¥åˆ†é…ã€‚ 3 å¦‚æœé€‰æ‹©Modularï¼Œå¯ä»¥æ ¹æ®nodeæ–‡ä»¶èŠ‚ç‚¹é¢œè‰²åºå·æ¥è‡ªå®šä¹‰èŠ‚ç‚¹é¢œè‰²ã€‚ 4 ä¸å¸¦labelçš„å›¾ï¼šåªéœ€æŠŠLabel ALL å˜æˆ Label Noneå³å¯ 3ï¼‰è„‘ç½‘ç»œå›¾æ˜¾ç¤º 4ï¼‰ç»“æœå¯¼å‡º 5ï¼‰è°ƒæ•´node label 5. ROI çš„ç»˜åˆ¶ å‚è€ƒï¼šAALæ¨¡æ¿åŠè„‘åŒºåŠŸèƒ½ä»‹ç» å…³äºBrainNet Viewerçš„æ›´å¤šå…·ä½“ä½¿ç”¨å¯ä»¥å‚è€ƒBrainNet_Manual.pdf","categories":[{"name":"EEG","slug":"EEG","permalink":"https://weisihong9.github.io/categories/EEG/"},{"name":"FBN","slug":"EEG/FBN","permalink":"https://weisihong9.github.io/categories/EEG/FBN/"}],"tags":[{"name":"FBN","slug":"FBN","permalink":"https://weisihong9.github.io/tags/FBN/"}]},{"title":"DiGraph","slug":"DiGraph","date":"2023-10-24T16:00:00.000Z","updated":"2023-10-25T12:59:19.571Z","comments":true,"path":"2023/10/25/DiGraph/","link":"","permalink":"https://weisihong9.github.io/2023/10/25/DiGraph/","excerpt":"","text":"ç›®çš„ï¼šç»˜åˆ¶åŠ æƒæœ‰å‘è¿æ¥å›¾ 1. ç”¨è¿æ¥è¾¹çš„é¢œè‰²è¡¨ç¤ºä¸¤ä¸ªèŠ‚ç‚¹ä¹‹é—´çš„å¼ºåº¦ 2. ç”¨è¾¹çš„æƒé‡æ¥è¡¨ç¤ºèŠ‚ç‚¹è¿æ¥çš„å¼ºåº¦ å‚è€ƒï¼š https://networkx.org/documentation/stable/auto_examples/drawing/plot_directed.html https://networkx.org/documentation/stable/reference/generated/networkx.drawing.nx_pylab.draw_networkx.html 0. åŠ è½½pythonåº“ 1234import matplotlib.pyplot as pltimport networkx as nximport matplotlib as mplimport numpy as np 1. ç”¨è¿æ¥è¾¹çš„é¢œè‰²è¡¨ç¤ºä¸¤ä¸ªèŠ‚ç‚¹ä¹‹é—´çš„å¼ºåº¦ 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970&#x27;&#x27;&#x27;0. è‡ªå·±çš„æƒé‡å€¼çŸ©é˜µ&#x27;&#x27;&#x27;value_new=[[0.,0.,0.,0.,0.,0.,0.,0.013], [0.,0.,0.,0.,0.,0.,0.,0.013], [0.,0.,0.,0.,0.,0.,0.,0.013], [0.,0.,0.,0.,0.,0.,0.,0.], [0.,0.,0.,0.,0.,0.,0.,0.], [0.,0.,0.,0.,0.,0.,0.005,0.], [0.,0.,0.,0.,0.,0.007,0.,0.008], [0.011,0.013,0.,0.012,0.,0.01,0.009,0.016]]&#x27;&#x27;&#x27; 1. åˆå§‹åŒ–å›¾&#x27;&#x27;&#x27; G = nx.MultiDiGraph()pos = nx.spring_layout(G)# è®¾ç½®èŠ‚ç‚¹åç§°row = np.array([&#x27;FL&#x27;,&#x27;FM&#x27;,&#x27;FR&#x27;,&#x27;TL&#x27;,&#x27;TR&#x27;,&#x27;C&#x27;,&#x27;P&#x27;,&#x27;O&#x27;])G.add_nodes_from([&#x27;FL&#x27;,&#x27;FM&#x27;,&#x27;FR&#x27;,&#x27;TL&#x27;,&#x27;TR&#x27;,&#x27;C&#x27;,&#x27;P&#x27;,&#x27;O&#x27;])&#x27;&#x27;&#x27; 2. å°†èŠ‚ç‚¹çš„è¿æ¥è¾¹æƒé‡åŠ å…¥æ„å»ºçš„å›¾&#x27;&#x27;&#x27;for j in range(0,8): for i in range(0,8): if value_new[i][j] != 0: G.add_weighted_edges_from([(row[j],row[i],value_new[i][j])])#è¾¹çš„èµ·ç‚¹ï¼Œç»ˆç‚¹ï¼Œæƒé‡ else: pass &#x27;&#x27;&#x27; 3. èŠ‚ç‚¹çš„è®¾ç½® &#x27;&#x27;&#x27; # èŠ‚ç‚¹å¤§å° node_sizes = [1000,1000,1000,1000,1000,1000,1000,1000]# èŠ‚ç‚¹é¢œè‰²node_color = [&#x27;g&#x27;,&#x27;g&#x27;,&#x27;g&#x27;,&#x27;g&#x27;,&#x27;g&#x27;,&#x27;g&#x27;,&#x27;g&#x27;,&#x27;g&#x27;]# è®¾ç½®èŠ‚ç‚¹ä½ç½®pos=&#123;&#x27;FL&#x27;:(38,75),&#x27;FM&#x27;:(40,80),&#x27;FR&#x27;:(42,75), &#x27;TL&#x27;:(37,64),&#x27;C&#x27;:(40,65), &#x27;TR&#x27;:(43,64), &#x27;P&#x27;:(38,53),&#x27;O&#x27;:(42,53)&#125;&#x27;&#x27;&#x27; 4. è¾¹çš„é¢œè‰²: ç”¨è¿æ¥è¾¹çš„é¢œè‰²è¡¨ç¤ºä¸¤ä¸ªèŠ‚ç‚¹ä¹‹é—´çš„å¼ºåº¦/ å¯ä»¥ç”¨è¾¹çš„æƒé‡æ¥è¡¨ç¤ºèŠ‚ç‚¹è¿æ¥çš„å¼ºåº¦ &#x27;&#x27;&#x27;edge_colors=[float(v[&#x27;weight&#x27;]) for (r,c,v) in G.edges(data=True)] cmap = plt.cm.jet # jetã€viridisã€plasmaã€infernoã€magmaã€cividis...&#x27;&#x27;&#x27; 5. ç»˜å›¾ &#x27;&#x27;&#x27; # ç»˜åˆ¶èŠ‚ç‚¹nx.draw_networkx_nodes(G,pos, node_size=node_sizes, #node_color=node_color, alpha=0.4 )# èŠ‚ç‚¹å­—ä½“å¤§å°nx.draw_networkx_labels(G,pos,font_size=15)# ç»˜åˆ¶è¿æ¥è¾¹edges = nx.draw_networkx_edges(G,pos, edge_color = edge_colors, #alpha=0.5, # é€æ˜åº¦ edge_cmap = cmap, connectionstyle=&#x27;arc3, rad = 0.25&#x27;, # arcæ§åˆ¶åŒå‘ï¼Œradè°ƒçº¿æ¡å¼§åº¦ width=5, )pc = mpl.collections.PatchCollection(edges, cmap=cmap)# æ˜¾ç¤ºcolorbarpc.set_array(edge_colors)ax = plt.gca()ax.set_axis_off()plt.colorbar(pc, ax=ax)# ä¿å­˜å›¾ç‰‡plt.title(&#x27;Weighted directed connected graph (colour of edges)&#x27;)plt.savefig(&quot;CE_Graph.png&quot;,dpi=600, bbox_inches=&#x27;tight&#x27;)plt.show() 2. ç”¨è¾¹çš„æƒé‡æ¥è¡¨ç¤ºèŠ‚ç‚¹è¿æ¥çš„å¼ºåº¦ 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859&#x27;&#x27;&#x27;0. è‡ªå·±çš„æƒé‡å€¼çŸ©é˜µ&#x27;&#x27;&#x27;value_new=[[0.,0.,0.,0.,0.,0.,0.,0.013], [0.,0.,0.,0.,0.,0.,0.,0.013], [0.,0.,0.,0.,0.,0.,0.,0.013], [0.,0.,0.,0.,0.,0.,0.,0.], [0.,0.,0.,0.,0.,0.,0.,0.], [0.,0.,0.,0.,0.,0.,0.005,0.], [0.,0.,0.,0.,0.,0.007,0.,0.008], [0.011,0.013,0.,0.012,0.,0.01,0.009,0.016]]&#x27;&#x27;&#x27; 1. åˆå§‹åŒ–å›¾&#x27;&#x27;&#x27; G = nx.MultiDiGraph()pos = nx.spring_layout(G)row = np.array([&#x27;FL&#x27;,&#x27;FM&#x27;,&#x27;FR&#x27;,&#x27;TL&#x27;,&#x27;TR&#x27;,&#x27;C&#x27;,&#x27;P&#x27;,&#x27;O&#x27;])G.add_nodes_from([&#x27;FL&#x27;,&#x27;FM&#x27;,&#x27;FR&#x27;,&#x27;TL&#x27;,&#x27;TR&#x27;,&#x27;C&#x27;,&#x27;P&#x27;,&#x27;O&#x27;])&#x27;&#x27;&#x27; 2. å°†èŠ‚ç‚¹çš„è¿æ¥è¾¹æƒé‡åŠ å…¥æ„å»ºçš„å›¾&#x27;&#x27;&#x27;for j in range(0,8): for i in range(0,8): if value_new[i][j] != 0: G.add_weighted_edges_from([(row[j],row[i],value_new[i][j]*300)]) # è¾¹çš„èµ·ç‚¹ï¼Œç»ˆç‚¹ï¼Œæƒé‡ ï¼Œå› ä¸ºæˆ‘çš„æƒé‡å®åœ¨å¤ªå°äº†ï¼Œæ‰€ä»¥æ•´ä½“æ‰©å¤§300å€ else: pass &#x27;&#x27;&#x27; 3. èŠ‚ç‚¹çš„è®¾ç½® &#x27;&#x27;&#x27; # èŠ‚ç‚¹å¤§å° node_sizes = [1000,1000,1000,1000,1000,1000,1000,1000]# èŠ‚ç‚¹é¢œè‰²node_color = [&#x27;g&#x27;,&#x27;g&#x27;,&#x27;g&#x27;,&#x27;g&#x27;,&#x27;g&#x27;,&#x27;g&#x27;,&#x27;g&#x27;,&#x27;g&#x27;]# è®¾ç½®èŠ‚ç‚¹ä½ç½®pos=&#123;&#x27;FL&#x27;:(38,75),&#x27;FM&#x27;:(40,80),&#x27;FR&#x27;:(42,75), &#x27;TL&#x27;:(37,64),&#x27;C&#x27;:(40,65), &#x27;TR&#x27;:(43,64), &#x27;P&#x27;:(38,53),&#x27;O&#x27;:(42,53)&#125;&#x27;&#x27;&#x27; 4. è¾¹çš„é¢œè‰²: ç”¨è¿æ¥è¾¹çš„é¢œè‰²è¡¨ç¤ºä¸¤ä¸ªèŠ‚ç‚¹ä¹‹é—´çš„å¼ºåº¦/ å¯ä»¥ç”¨è¾¹çš„æƒé‡æ¥è¡¨ç¤ºèŠ‚ç‚¹è¿æ¥çš„å¼ºåº¦ &#x27;&#x27;&#x27;weight=[float(v[&#x27;weight&#x27;]) for (r,c,v) in G.edges(data=True)] &#x27;&#x27;&#x27; 5. ç»˜å›¾ &#x27;&#x27;&#x27; # ç»˜åˆ¶èŠ‚ç‚¹nx.draw_networkx_nodes(G,pos, node_size=node_sizes, #node_color=node_color, alpha=0.4 )# èŠ‚ç‚¹å­—ä½“å¤§å°nx.draw_networkx_labels(G,pos,font_size=15)# ç»˜åˆ¶è¿æ¥è¾¹edges = nx.draw_networkx_edges(G,pos, edge_color = &#x27;lightseagreen&#x27;, #alpha=0.5, # é€æ˜åº¦ edge_cmap = cmap, connectionstyle=&#x27;arc3, rad = 0.25&#x27;, # arcæ§åˆ¶åŒå‘ï¼Œradè°ƒçº¿æ¡å¼§åº¦ width=weight )# ä¿å­˜å›¾ç‰‡plt.savefig(&quot;SE_Graph.png&quot;,dpi=600, bbox_inches=&#x27;tight&#x27;)plt.show()","categories":[{"name":"Graph","slug":"Graph","permalink":"https://weisihong9.github.io/categories/Graph/"},{"name":"EEG","slug":"Graph/EEG","permalink":"https://weisihong9.github.io/categories/Graph/EEG/"}],"tags":[{"name":"BEAM","slug":"BEAM","permalink":"https://weisihong9.github.io/tags/BEAM/"}]},{"title":"CrossFrequencyCoupling","slug":"CrossFrequencyCoupling","date":"2023-07-05T05:00:49.000Z","updated":"2023-07-06T08:00:48.066Z","comments":true,"path":"2023/07/05/CrossFrequencyCoupling/","link":"","permalink":"https://weisihong9.github.io/2023/07/05/CrossFrequencyCoupling/","excerpt":"","text":"ç›®çš„ï¼šä»‹ç»è·¨é¢‘è€¦åˆçš„èƒŒæ™¯åŠå¸¸ç”¨çš„è®¡ç®—æ–¹æ³• 1ã€èƒŒæ™¯ ç¥ç»ç§‘å­¦çš„æ ¸å¿ƒé—®é¢˜ä¹‹ä¸€æ˜¯ç¥ç»æ´»åŠ¨å¦‚ä½•åœ¨ä¸åŒçš„ç©ºé—´å’Œæ—¶é—´å°ºåº¦ä¸Šåè°ƒã€‚ è·¨é¢‘ç‡è€¦åˆ(Cross-frequency coupling, CFC) å·²è¢«æå‡ºåœ¨æ—¶é—´å’Œç©ºé—´å°ºåº¦ä¸Šåè°ƒç¥ç»åŠ¨åŠ›å­¦ã€‚ æ—¶é—´å°ºåº¦ï¼šç¥ç»æŒ¯è¡ä¹‹é—´çš„ç›¸å¹…è€¦åˆã€‚ä¾‹å¦‚ï¼Œä½é¢‘æŒ¯è¡çš„ç›¸ä½å¯ä»¥å½±å“é«˜é¢‘æŒ¯è¡çš„æŒ¯å¹…ï¼Œä»è€Œè°ƒèŠ‚ç¥ç»æ´»åŠ¨çš„æ—¶åºï¼Œå®ç°ä¿¡æ¯å¤„ç†å’Œé›†æˆã€‚ ç©ºé—´å°ºåº¦ï¼šç¥ç»æŒ¯è¡ä¹‹é—´çš„ç©ºé—´è€¦åˆã€‚ä¾‹å¦‚ï¼Œä¸åŒé¢‘ç‡èŒƒå›´å†…çš„ç¥ç»æŒ¯è¡å¯ä»¥åœ¨ä¸åŒè„‘åŒºä¹‹é—´ç›¸äº’è°ƒèŠ‚ï¼Œå½¢æˆç¥ç»ç½‘ç»œï¼Œå®ç°ä¿¡æ¯çš„ä¼ é€’å’Œæ•´åˆã€‚ EEGä¿¡å·çš„CFCæ˜¯æŒ‡ä¸åŒé¢‘ç‡èŒƒå›´å†…çš„ç¥ç»æŒ¯è¡ä¹‹é—´å­˜åœ¨ç›¸äº’è°ƒèŠ‚å’Œäº¤äº’ä½œç”¨çš„ç°è±¡ã€‚æ¢å¥è¯è¯´ï¼ŒCFCå®é™…ä¸Šæ˜¯ä¸åŒé¢‘å¸¦EEGçš„å¹…åº¦/é¢‘ç‡/ç›¸ä½ä¹‹é—´çš„å…³ç³»ã€‚å¸¸è§çš„è€¦åˆå…³ç³»å¦‚ä¸‹ï¼šã€æ…¢éœ‡è¡ï¼ˆSlow Oscillationï¼ŒSOï¼‰ï¼›å¿«éœ‡è¡ï¼ˆ Fast Oscillationï¼ŒFO ï¼‰ã€‘ ç›¸ä½-å¹…åº¦è€¦åˆ(phase-amplitude couplingï¼ŒPAC)ï¼šSOçš„ç›¸ä½ä¸FOå¹…åº¦ä¹‹é—´çš„è€¦åˆï¼Œä¹Ÿç§°ä¸ºâ€œåµŒå¥—â€ã€‚ç›®å‰ç ”ç©¶æ¯”è¾ƒå¤šçš„æ˜¯Î¸ - Î³å’ŒÎ± - Î³ä¹‹é—´çš„PACã€‚ ç›¸ä½-é¢‘ç‡è€¦åˆ(phase- frequency couplingï¼ŒPFC)ï¼šSOçš„ç›¸ä½å’ŒFOçš„é¢‘ç‡ä¹‹é—´çš„è€¦åˆã€‚ ç›¸ä½-ç›¸ä½è€¦åˆ(phase-phase couplingï¼ŒPPC)ï¼šSOå’ŒFOç›¸ä½ä¹‹é—´çš„è€¦åˆã€‚ 2ã€CFCåœ¨ç¥ç»ç–¾ç—…ä¸­çš„åº”ç”¨ è·¨é¢‘è€¦åˆä½œä¸ºä¸€ç§ç¥ç»æœºåˆ¶ï¼Œåœ¨å¤šç§ç¥ç»ç–¾ç—…ä¸­éƒ½å¾—åˆ°äº†å¹¿æ³›ç ”ç©¶ï¼š ç™«ç—«ï¼šç ”ç©¶è¡¨æ˜[1]ï¼Œ è·¨é¢‘é¢‘ç‡è€¦åˆæ˜¯å®šä½ç™«ç—«ç»„ç»‡çš„æœ‰ç”¨ç”Ÿç‰©æ ‡å¿—ç‰©ã€‚ å¸•é‡‘æ£®ç—…ï¼šç ”ç©¶è¡¨æ˜[2]ï¼Œtheta-gammaè·¨é¢‘è€¦åˆå¯ä»¥ä½œä¸ºå¸•é‡‘æ£®ç–¾ç—…çš„ç”Ÿç‰©æ ‡å¿—ï¼Œå¹¶æœ‰åŠ©äºå¯¹å¸•é‡‘æ£®ç–¾ç—…çš„æ—©æœŸè¯Šæ–­å’Œæ²»ç–—è¿›è¡Œç›‘æµ‹ã€‚ ç²¾ç¥åˆ†è£‚ç—‡ï¼šç ”ç©¶è¡¨æ˜[3]ï¼Œ theta-gammaè·¨é¢‘è€¦åˆå‡å¼±ä¸è®¤çŸ¥éšœç¢ç—‡çŠ¶çš„ä¸¥é‡ç¨‹åº¦æœ‰å…³ã€‚ æŠ‘éƒç—‡ï¼šç ”ç©¶è¡¨æ˜[4]ï¼ŒæŠ‘éƒç—‡æ‚£è€…ä¸å¥åº·å¯¹ç…§ç»„ç›¸æ¯”ï¼Œå‰é¢å¶çš®å±‚çš„theta-gammaè·¨é¢‘è€¦åˆå­˜åœ¨æ˜¾è‘—å·®å¼‚ã€‚ 3ã€CFCå¸¸ç”¨è®¡ç®—æ–¹æ³• [5] é”ç›¸å€¼ï¼ˆphase-locking valueï¼ŒPLVï¼‰ å¹³å‡å‘é‡é•¿åº¦ï¼ˆmean vector lengthï¼ŒMVLï¼‰ è°ƒåˆ¶æŒ‡æ•°ï¼ˆmodulation indexï¼ŒMIï¼‰ 3.1 é”ç›¸å€¼ï¼ˆphase-locking valueï¼ŒPLVï¼‰ å®šä¹‰ï¼šPLVé€šè¿‡æ¯”è¾ƒä¸¤ä¸ªä¿¡å·çš„ç›¸ä½å·®æ¥è¯„ä¼°å®ƒä»¬ä¹‹é—´çš„åŒæ­¥æ€§ã€‚å¦‚æœä¸¤ä¸ªä¿¡å·å­˜åœ¨ç›¸ä½-å¹…åº¦è€¦åˆï¼Œé‚£ä¹ˆé«˜é¢‘æ—¶é—´åºåˆ—çš„æŒ¯å¹…å°†åœ¨ä½é¢‘æŒ¯è¡ã€‚ è®¡ç®—æ­¥éª¤ è®¡ç®—å…¬å¼ PLV=âˆ£âˆ‘t=1nei(Î¸ltâˆ’Î¸ut)nâˆ£PLV=|\\frac{ {\\sum_{t=1}^{n}{e^{i(\\theta _{lt}-\\theta _{ut})} } } }{n}| PLV=âˆ£nâˆ‘t=1nâ€‹ei(Î¸ltâ€‹âˆ’Î¸utâ€‹)â€‹âˆ£ å…¶ä¸­ nï¼šæ•°æ®ç‚¹æ€»æ•° tï¼šæ—¶é—´æ•°æ®ç‚¹ Î¸ltï¼štæ—¶åˆ»çš„ä½é¢‘ç›¸ä½è§’ Î¸utï¼šå¸Œå°”ä¼¯ç‰¹å˜æ¢åçš„é«˜é¢‘æŒ¯å¹…æ—¶é—´åºåˆ—åœ¨tæ—¶åˆ»çš„ç›¸ä½è§’ ä¼˜ç‚¹å’Œç¼ºç‚¹ï¼š ä¼˜ç‚¹ï¼šå—å™ªå£°å½±å“å°ã€‚ ç¼ºç‚¹ï¼šå¸Œå°”ä¼¯ç‰¹è½¬æ¢åçš„æŒ¯å¹…æ—¶é—´åºåˆ—ä¸ä¸€å®šæ˜¯çª„å¸¦æŒ¯è¡ã€‚ pythonä»£ç å®ç°ï¼š 1234567# åˆ©ç”¨PLVè®¡ç®—ç›¸å¹…è€¦åˆdef PLV_CFC_WSH(phase, amp): # phaseï¼šä½é¢‘ä¿¡å·çš„ç›¸ä½ # ampï¼šé«˜é¢‘ä¿¡å·çš„æŒ¯å¹… amp_phi = np.angle(hilbert(amp)) # é«˜é¢‘ä¿¡å·æŒ¯å¹…çš„ç›¸ä½ observed_plv = np.abs(np.sum(np.exp(1j*(phase - amp_phi)))/len(phase)) return observed_plv 3.2 å¹³å‡å‘é‡é•¿åº¦ï¼ˆmean vector lengthï¼ŒMVLï¼‰ å®šä¹‰ï¼šMVLæ˜¯ä¸€ä¸ªå‘é‡é›†åˆä¸­å„ä¸ªå‘é‡é•¿åº¦çš„å¹³å‡å€¼ï¼Œå®ƒæä¾›äº†å¯¹å‘é‡é›†åˆæ•´ä½“å¤§å°æˆ–å¹…åº¦çš„ä¸€ç§åº¦é‡ã€‚åœ¨CFCçš„è®¡ç®—ä¸­ï¼Œå°†å¯¹åº”æ—¶åˆ»çš„ä½é¢‘ä¿¡å·çš„ç›¸ä½è§’ä½œä¸ºå‘é‡çš„æ–¹å‘ï¼Œé«˜é¢‘ä¿¡å·çš„æŒ¯å¹…ä½œä¸ºå‘é‡çš„å¹…åº¦ã€‚ è®¡ç®—æ­¥éª¤ï¼š è®¡ç®—å…¬å¼ï¼š MVL=âˆ£âˆ‘t=1nateiÎ¸tnâˆ£MVL=\\left | \\frac{ {\\textstyle \\sum_{t=1}^{n}{a_{t} e^{i\\theta _{t}} } } }{n}\\right | MVL=âˆ£âˆ£âˆ£âˆ£âˆ£â€‹nâˆ‘t=1nâ€‹atâ€‹eiÎ¸tâ€‹â€‹âˆ£âˆ£âˆ£âˆ£âˆ£â€‹ å…¶ä¸­: nï¼šæ•°æ®ç‚¹æ€»æ•° tï¼šæ—¶é—´æ•°æ®ç‚¹ atï¼šé«˜é¢‘æŒ¯å¹…æ—¶é—´åºåˆ—åœ¨tæ—¶åˆ»çš„å¹…å€¼ Î¸tï¼šä½é¢‘ç›¸ä½æ—¶é—´åºåˆ—åœ¨tæ—¶åˆ»çš„ç›¸ä½è§’ ä¼˜ç‚¹å’Œç¼ºç‚¹ï¼š ä¼˜ç‚¹ï¼šå¯¹äºé•¿æ•°æ®æ®µï¼Œé«˜é‡‡æ ·ç‡ï¼Œé«˜ä¿¡å™ªæ¯”çš„ä¿¡å·ï¼Œå»ºè®®ä½¿ç”¨MVLã€‚ ç¼ºç‚¹ï¼š MVLçš„è®¡ç®—å—åˆ°é¢‘ç‡æŒ¯å¹…çš„æ•´ä½“å¹…åº¦å½±å“ã€‚å¦‚æœæŸä¸ªé¢‘ç‡çš„æŒ¯å¹…è¾ƒå¤§ï¼Œé‚£ä¹ˆå®ƒå°†åœ¨è®¡ç®—MVLæ—¶æœ‰æ›´å¤§çš„æƒé‡ã€‚è¿™å¯èƒ½ä¼šå¯¼è‡´å¯¹æ•´ä¸ªå‘é‡é›†åˆå¤§å°æˆ–å¹…åº¦çš„è¯„ä¼°å­˜åœ¨ä¸€å®šçš„åå·®ã€‚ æŒ¯å¹…å¼‚å¸¸å€¼å¯èƒ½ä¼šå¼ºçƒˆå½±å“å¹³å‡å‘é‡é•¿åº¦ã€‚ ä¸åŒå‘é‡ä¹‹é—´çš„ç›¸ä½è§’å·®å¼‚å¯èƒ½ä¼šå½±å“å¹³å‡å‘é‡é•¿åº¦çš„è®¡ç®—ç»“æœã€‚ pythonä»£ç å®ç°ï¼š 1234567# åˆ©ç”¨MVLè®¡ç®—ç›¸å¹…è€¦åˆdef MVL_CFC_WSH(phase, amp): # phaseï¼šä½é¢‘ä¿¡å·çš„ç›¸ä½ # ampï¼šé«˜é¢‘ä¿¡å·çš„æŒ¯å¹… amp_nor = (amp - np.min(amp)) / (np.max(amp) - np.min(amp)) # æŒ¯å¹…å½’ä¸€åŒ– observed_mvl = np.abs(np.mean(amp_nor * np.exp(1j*phase))) return observed_mvl 3.3 è°ƒåˆ¶æŒ‡æ•°ï¼ˆmodulation indexï¼ŒMIï¼‰ å®šä¹‰ï¼šMIé€šè¿‡è®¡ç®—å¹…åº¦å’Œç›¸ä½çš„ç†µæ¥ä¼°è®¡å¹…åº¦è°ƒåˆ¶æŒ‡æ•°ã€‚ è®¡ç®—æ­¥éª¤ï¼š è®¡ç®—å…¬å¼ï¼š p(j)=aË‰âˆ‘k=1NaË‰k\\begin{aligned}p(j)=\\frac{\\bar{a} }{ {\\textstyle \\sum_{k=1}^{N}} \\bar{a} _{k}} \\end{aligned} p(j)=âˆ‘k=1Nâ€‹aË‰kâ€‹aË‰â€‹â€‹ Ää¸ºå•ä¸ªbinçš„å¹³å‡æŒ¯å¹…ï¼Œkä¸ºbinsçš„è¿è¡ŒæŒ‡æ•°ï¼ŒNä¸ºbinsçš„æ€»æ•°ï¼›pæ˜¯ä¸€ä¸ªæœ‰Nä¸ªå€¼çš„å‘é‡ï¼›H(p)ä¸ºé¦™å†œç†µã€‚ H(p)=âˆ’âˆ‘j=1Np(j)logp(j)KL(U,X)=logNâˆ’H(p)MI=KL(U,X)logN\\begin{aligned} H(p)=- {\\textstyle \\sum_{j=1}^{N}p(j)logp(j)}\\\\ KL(U,X)=logN-H(p)\\\\ MI=\\frac{KL(U,X)}{logN} \\end{aligned} H(p)=âˆ’âˆ‘j=1Nâ€‹p(j)logp(j)KL(U,X)=logNâˆ’H(p)MI=logNKL(U,X)â€‹â€‹ Uä¸ºå‡åŒ€åˆ†å¸ƒï¼ŒXä¸ºæ•°æ®åˆ†å¸ƒã€‚ KL(U, K): KLæ•£åº¦æè¿°äº†ç”¨å‡åŒ€åˆ†å¸ƒUæ¥ä¼°è®¡æ•°æ®çš„çœŸå®åˆ†å¸ƒXçš„ç¼–ç æŸå¤±ã€‚ ä¼˜ç‚¹å’Œç¼ºç‚¹ï¼š ä¼˜ç‚¹ï¼š å½’ä¸€åŒ–ç†µæ˜¯ä¸€ç§å¸¸ç”¨çš„ä¿¡å·å¤æ‚æ€§åº¦é‡ï¼Œå¯ä»¥åæ˜ ä¿¡å·çš„ä¸ç¡®å®šæ€§å’Œä¿¡æ¯ä¸°å¯Œåº¦ã€‚ å¯¹äºæ›´çŸ­çš„æ•°æ®ï¼Œæ›´ä½çš„é‡‡æ ·ç‡ï¼Œæ›´é«˜å™ªå£°çš„æ•°æ®ï¼Œå»ºè®®ä½¿ç”¨MIã€‚ MIæ˜¯ä½¿ç”¨æœ€å¤šçš„CFCæ–¹æ³•ã€‚ ç¼ºç‚¹ï¼š 4. ä¾èµ–äºç‰¹å®šçš„ç†µæµ‹é‡æ–¹æ³•ï¼› 5. å¯¹æ•°æ®é¢„å¤„ç†çš„è¦æ±‚è¾ƒé«˜ï¼› pythonä»£ç å®ç°ï¼š 12345678910111213141516# åˆ©ç”¨MIè®¡ç®—ç›¸å¹…è€¦åˆdef MI_CFC_WSH(phase, amp, nbins): # phaseï¼šä½é¢‘ä¿¡å·çš„ç›¸ä½ # ampï¼šé«˜é¢‘ä¿¡å·çš„æŒ¯å¹… # nbinsï¼šåˆ’åˆ†çš„ç®±å­æ•° bins = np.linspace(-np.pi, np.pi, nbins+1) # è®¡ç®—æ¯ä¸ªç›¸ä½åŒºé—´å†…çš„æŒ¯å¹…å‡å€¼ meanAmp = np.zeros(nbins) for i in range(nbins): indices = np.logical_and(phase &gt;= bins[i], phase &lt; bins[i+1]) meanAmp[i] = np.mean(amp[indices]) Pj = meanAmp/np.sum(meanAmp) H_Pj = -np.sum((Pj) * np.log(Pj)) KL = np.log(nbins) - H_Pj observed_mi = KL / np.log(nbins) return [observed_mi, meanAmp] 4ã€ç½®æ¢æ£€éªŒ å®šä¹‰ï¼šç½®æ¢æ£€éªŒæ˜¯ä¸€ç§ç»Ÿè®¡æ–¹æ³•ï¼Œé€šè¿‡å¯¹æ•°æ®è¿›è¡Œéšæœºé‡æ–°æ’åºæˆ–é‡ç»„ï¼Œäº§ç”Ÿä¸€ç»„éšæœºåˆ†å¸ƒï¼Œä»è€Œæä¾›äº†å¯¹è§‚å¯Ÿåˆ°çš„æ•ˆåº”è¿›è¡Œæ¯”è¾ƒçš„åŸºå‡†ã€‚åœ¨è®¡ç®—CFCæ—¶ï¼Œè¿›è¡Œç½®æ¢æ£€éªŒæ˜¯ä¸ºäº†è¯„ä¼°è§‚å¯Ÿåˆ°çš„è€¦åˆæ•ˆåº”æ˜¯å¦æ˜¾è‘—ï¼Œå³æ˜¯å¦è¶…å‡ºäº†éšæœºé¢„æœŸã€‚ è®¡ç®—æ­¥éª¤ï¼š éšæœºåœ¨å¹…å€¼æ—¶é—´åºåˆ—æŸæ•°æ®ç‚¹ä¸Šå°†æ•°æ®åˆ†ä¸ºä¸¤éƒ¨åˆ†ï¼Œå¹¶å°†ä¸¤éƒ¨åˆ†æ—¶é—´åºåˆ—çš„é¡ºåºé¢ å€’ï¼Œæ„é€ å‡ºç½®æ¢å¹…å€¼æ—¶é—´åºåˆ—ã€‚ é€šè¿‡è®¡ç®—åŸå§‹ç›¸ä½æ—¶é—´åºåˆ—å’Œç½®æ¢å¹…å€¼æ—¶é—´åºåˆ—(åä¹‹äº¦ç„¶)ä¹‹é—´çš„è€¦åˆå€¼æ¥æ„é€ æ´—ç‰Œè€¦åˆå€¼ã€‚ è¿™ç§ç”Ÿæˆæ›¿ä»£æ•°æ®çš„æ–¹æ³•æ˜¯æœ€ä¿å®ˆçš„ï¼Œå› ä¸ºé™¤äº†æ‰€ç ”ç©¶çš„ç›¸ä½è§’å’Œå¹…å€¼ä¹‹é—´çš„æ—¶é—´å…³ç³»ï¼Œå®ƒä¿ç•™äº†è„‘ç”µå›¾æ•°æ®çš„æ‰€æœ‰ç‰¹å¾ï¼Œ æ´—ç‰Œé€šå¸¸é‡å¤200-1000æ¬¡ã€‚ å°†è§‚å¯Ÿåˆ°çš„è€¦åˆå€¼ CFCobservedCFC_{observed}CFCobservedâ€‹ æ ‡å‡†åŒ–ä¸ºæ´—ç‰Œè€¦åˆå€¼ CFCshuffledCFC_{shuffled}CFCshuffledâ€‹ çš„åˆ†å¸ƒï¼Œå…¬å¼å¦‚ä¸‹ï¼š CFCz=CFCobservedâˆ’Î¼CFCshuffledÏƒCFCshuffled\\begin{aligned} CFC_{z} = \\frac{CFC_{observed} - \\mu CFC_{shuffled} }{\\sigma CFC_{shuffled}} \\end{aligned} CFCzâ€‹=ÏƒCFCshuffledâ€‹CFCobservedâ€‹âˆ’Î¼CFCshuffledâ€‹â€‹â€‹ å…¶ä¸­CFCCFCCFCä¸ºè€¦åˆå€¼ï¼Œ$ \\mu $ ä¸º CFCshuffledCFC_{shuffled}CFCshuffledâ€‹ å‡å€¼ï¼Œ$\\sigma $ ä¸º CFCshuffledCFC_{shuffled}CFCshuffledâ€‹ æ ‡å‡†å·®ã€‚åªæœ‰å½“ CFCobservedCFC_{observed}CFCobservedâ€‹ å¤§äº95%çš„CFCshuffledCFC_{shuffled}CFCshuffledâ€‹æ—¶ï¼Œæ‰è¢«å®šä¹‰ä¸ºæ˜¾è‘—ã€‚å› ä¸ºzå€¼ç­‰äº1.64å¯¹åº”çš„på€¼ä¸º5%ï¼Œæ‰€ä»¥å½“CFCzCFC_{z}CFCzâ€‹çš„å€¼å¤§äº1.64 æ‰è¢«å®šä¹‰ä¸ºæ˜¾è‘—ã€‚ pythonä»£ç å®ç° 123456789101112131415161718192021npnts = len(eeg)n_iter = 1000PLV_shuffled = np.zeros(n_iter)MVL_shuffled = np.zeros(n_iter)MI_shuffled = np.zeros(n_iter)for ni in range(n_iter): cutpoint = random.randrange(np.round(npnts/10), np.round(npnts*.9)) new_amp = np.concatenate((amp[cutpoint:] , amp[:cutpoint])) PLV_shuffled[ni] = PLV_CFC_WSH(phase, new_amp) MVL_shuffled[ni] = MVL_CFC_WSH(phase, new_amp) [MI, meanAmp] = MI_CFC_WSH(phase, new_amp, n_hist_bins) MI_shuffled[ni] = MI PLV_CFCz = (PLV_observed - np.mean(PLV_shuffled))/np.std(PLV_shuffled)MVL_CFCz = (MVL_observed- np.mean(MVL_shuffled))/np.std(MVL_shuffled)MI_CFCz = (MI_observed - np.mean(MI_shuffled))/np.std(MI_shuffled)print(&#x27;PLV_CFCz: &#x27;,PLV_CFCz)print(&#x27;MVL_CFCz: &#x27;,MVL_CFCz)print(&#x27;MI_CFCz: &#x27;,MI_CFCz) 5ã€å®ä¾‹åˆ†æ 5.1 æ¨¡æ‹Ÿä¿¡å·çš„CFC æ„å»ºè€¦åˆä¿¡å· 12345678910111213141516171819fs = 1000 # sampling frequency (samples per second/Hz) dt = 1/fs # seconds per sample stopTime = 5 # length of signal in seconds t = np.arange(0, stopTime-dt, dt).T # time vector in seconds stopTime_plot = 2 #limit time axis for improved visualization # ç”Ÿæˆè°ƒåˆ¶åçš„ä¿¡å·f_P = 4 # ä½é¢‘ç›¸ä½f_A = 32 # é«˜é¢‘å¹…åº¦f_AM = 0.5 # f_AMè¡¨ç¤ºæŒ¯å¹…è°ƒåˆ¶çš„é¢‘ç‡Afp = 1 # AfPæ˜¯å›ºå®šçš„æ ‡é‡ï¼Œå†³å®šSOï¼ˆæ…¢æ³¢ï¼‰çš„å³°å€¼æŒ¯å¹…ã€K = 2 # Kæ˜¯å›ºå®šçš„æ ‡é‡ï¼Œå†³å®šFOï¼ˆå¿«æ³¢ï¼‰çš„å³°å€¼æŒ¯å¹…ã€beta = 0.3Xf_P = Afp * np.sin(2 * np.pi * f_P * t) # æ…¢æ³¢ï¼ˆä½é¢‘ç›¸ä½ï¼‰Afa = K * beta * np.sin(2 * np.pi * f_AM * t) Xf_A = Afa * np.sin(2 * np.pi * f_A * t) # å¿«æ³¢ï¼ˆé«˜é¢‘æŒ¯å¹…ï¼‰signal = Xf_A + Xf_P è®¡ç®—CFC 12345678910111213141516171819202122232425262728293031323334phasefilt = filterFGx(signal, fs, f_P, 0.5)phase = np.angle(hilbert(phasefilt))ampfilt = filterFGx(signal, fs, f_A, 20)amp = np.abs(hilbert(ampfilt))**2# è®¡ç®—è§‚æµ‹CFCPLV_observed = PLV_CFC_WSH(phase, amp)MVL_observed = MVL_CFC_WSH(phase, amp)n_hist_bins = 18[MI_observed, meanAmp] = MI_CFC_WSH(phase, amp, n_hist_bins)# ç½®æ¢æ£€éªŒï¼Œè®¡ç®—æ´—ç‰ŒCFCnpnts = len(signal)n_iter = 1000PLV_shuffled = np.zeros(n_iter)MVL_shuffled = np.zeros(n_iter)MI_shuffled = np.zeros(n_iter)for ni in range(n_iter): cutpoint = random.randrange(np.round(npnts/10), np.round(npnts*.9)) new_amp = np.concatenate((amp[cutpoint:] , amp[:cutpoint])) PLV_shuffled[ni] = PLV_CFC_WSH(phase, new_amp) MVL_shuffled[ni] = MVL_CFC_WSH(phase, new_amp) [MI, meanAmp] = MI_CFC_WSH(phase, new_amp, n_hist_bins) MI_shuffled[ni] = MI PLV_CFCz = (PLV_observed - np.mean(PLV_shuffled))/np.std(PLV_shuffled)MVL_CFCz = (MVL_observed- np.mean(MVL_shuffled))/np.std(MVL_shuffled)MI_CFCz = (MI_observed - np.mean(MI_shuffled))/np.std(MI_shuffled)print(&#x27;PLV_CFCz: &#x27;,PLV_CFCz)print(&#x27;MVL_CFCz: &#x27;,MVL_CFCz)print(&#x27;MI_CFCz: &#x27;,MI_CFCz) 5.2 EEGä¿¡å·çš„CFC åŠ è½½EEGä¿¡å· 123456789data = scipy.io.loadmat(&#x27;accumbens_eeg.mat&#x27;)srate = 1000npnts = len(data)eeg = data[&#x27;eeg&#x27;].reshape(-1)fig = plt.figure(figsize=(10, 4),dpi=600)ax1 = fig.add_subplot(1, 1, 1) # å­å›¾1ax1.plot(eeg, label=&#x27;eeg_data&#x27;)ax1.legend()plt.show() è®¡ç®—CFC 1234567891011121314151617181920212223242526272829303132333435# define frequencies for phase and for amplitudephas_freqs = np.arange(5, 20, 2)ampl_freqs = np.arange(30, 150, 5)# number of iterations used for permutation testingn_iter = 500# initialize output phase-amplitude matrixphaseamp = np.zeros([len(phas_freqs),len(ampl_freqs)])# loop over frequencies for phasefor lower_fi in range(len(phas_freqs)): # get phase values phasefilt = filterFGx(eeg, srate, phas_freqs[lower_fi], phas_freqs[lower_fi]*.4) phase = np.angle(hilbert(phasefilt)) # phase = angle(hilbert(phasefilt)) for upper_fi in range(len(ampl_freqs)): ampfilt = filterFGx(eeg, srate, ampl_freqs[upper_fi], ampl_freqs[upper_fi]*.78) amplit = np.abs(hilbert(ampfilt))**2 # calculate observed modulation index(MVL) [modidx, _] = MI_CFC_WSH(phase, amplit, 30) # now use permutation testing to get Z-value bm = np.zeros(n_iter) for bi in range (n_iter): cutpoint = random.randrange(np.round(npnts/10), np.round(npnts*.9)) new_amp = np.concatenate((amplit[cutpoint:] , amplit[:cutpoint])) [mi, _] = MI_CFC_WSH(phase, new_amp, 30) bm[bi] = mi # the value we use is the normalized distance away from the mean of # boot-strapped values phaseamp[lower_fi, upper_fi] = (modidx - np.mean(bm)) / np.std(bm) å¯è§†åŒ– 1234fig, ax = plt.subplots()CFC_WSH = ax.contourf(phas_freqs, ampl_freqs, phaseamp.T)cbar = fig.colorbar(CFC_WSH)plt.show() å‚è€ƒæ–‡çŒ® [1] Li, C., et al., 2021. High-frequency hubs of the ictal cross-frequency coupling network predict surgical outcome in epilepsy patients. IEEE Transactions on Neural Systems and Rehabilitation Engineering, 29, pp.1290-1299. (2åŒº) [2] Salimpour, Y. and Anderson, W.S., 2019. Cross-frequency coupling based neuromodulation for treating neurological disorders. Frontiers in neuroscience, 13, p.125. (3åŒº) [3] Musaeus, C.S., et al., 2020. Electroencephalographic cross-frequency coupling as a sign of disease progression in patients with mild cognitive impairment: a pilot study. Frontiers in neuroscience, 14, p.790. (3åŒº) [4] Zhang, W., et al., 2023. Altered fronto-central theta-gamma coupling in major depressive disorder during auditory steady-state responses. Clinical Neurophysiology, 146, pp.65-76. (3åŒº) [5] HÃ¼lsemann, Mareike J., Ewald Naumann and BjÃ¶rn Rasch. ã€ŠQuantification of Phase-Amplitude Coupling in Neuronal Oscillations: Comparison of Phase-Locking Value, Mean Vector Length, Modulation Index, and Generalized-Linear-Modeling-Cross-Frequency-Couplingã€‹. Frontiers in Neuroscience (2019). (3åŒº)","categories":[{"name":"EEG","slug":"EEG","permalink":"https://weisihong9.github.io/categories/EEG/"}],"tags":[{"name":"CFC","slug":"CFC","permalink":"https://weisihong9.github.io/tags/CFC/"}]},{"title":"EEG_TopoMap","slug":"EEG_TopoMap","date":"2023-07-02T16:00:00.000Z","updated":"2023-07-05T05:08:47.908Z","comments":true,"path":"2023/07/03/EEG_TopoMap/","link":"","permalink":"https://weisihong9.github.io/2023/07/03/EEG_TopoMap/","excerpt":"","text":"ç›®çš„ï¼šåˆ©ç”¨MNEå®ç°è‡ªå®šä¹‰çŸ©é˜µå¤§è„‘æ‹“æ‰‘å›¾çš„ç»˜åˆ¶ 0ã€åŠ è½½pythonåº“ 123456import numpy as npimport matplotlib.pyplot as pltimport pandas as pdimport mne%matplotlib qt 1ã€è·å–å¯ç”¨çš„ç”µæå¸ƒå±€ç³»ç»Ÿ åœ¨ä½¿ç”¨MNEè¿›è¡ŒEEGä¿¡å·çš„å¯è§†åŒ–æ“ä½œæ—¶ï¼Œå¾€å¾€éœ€è¦å¯¼å…¥å¯¹åº”ç”µæçš„ä½ç½®ä¿¡æ¯ï¼ŒMNEä¸­æœ‰å†…ç½®çš„å¸¸è§ç”µæå¸ƒå±€ç³»ç»Ÿï¼Œé€šè¿‡è°ƒç”¨ä¸‹é¢æŒ‡ä»¤è¿›è¡Œå¯¼å…¥ï¼š 123456789101112131415161718192021222324252627282930mne.channels.get_builtin_montages()# output:[&#x27;standard_1005&#x27;, &#x27;standard_1020&#x27;, &#x27;standard_alphabetic&#x27;, &#x27;standard_postfixed&#x27;, &#x27;standard_prefixed&#x27;, &#x27;standard_primed&#x27;, &#x27;biosemi16&#x27;, &#x27;biosemi32&#x27;, &#x27;biosemi64&#x27;, &#x27;biosemi128&#x27;, &#x27;biosemi160&#x27;, &#x27;biosemi256&#x27;, &#x27;easycap-M1&#x27;, &#x27;easycap-M10&#x27;, &#x27;EGI_256&#x27;, &#x27;GSN-HydroCel-32&#x27;, &#x27;GSN-HydroCel-64_1.0&#x27;, &#x27;GSN-HydroCel-65_1.0&#x27;, &#x27;GSN-HydroCel-128&#x27;, &#x27;GSN-HydroCel-129&#x27;, &#x27;GSN-HydroCel-256&#x27;, &#x27;GSN-HydroCel-257&#x27;, &#x27;mgh60&#x27;, &#x27;mgh70&#x27;, &#x27;artinis-octamon&#x27;, &#x27;artinis-brite23&#x27;, &#x27;brainproducts-RNP-BA-128&#x27;] ä»ä¸Šé¢çš„è¾“å‡ºå¯ä»¥çœ‹å‡ºï¼ŒMNEä¸­å…±æœ‰27ä¸ªå¯ç”¨çš„ç”µæå¸ƒå±€ç³»ç»Ÿï¼Œå…·ä½“é€‰æ‹©å“ªä¸€ä¸ªè¦çœ‹ä½ é‡‡é›†æ•°æ®æ—¶ä½¿ç”¨çš„è„‘ç”µå¸½ç”µæå¸ƒå±€ç³»ç»Ÿæ˜¯å“ªä¸ªã€‚ 2ã€åˆ©ç”¨MNEè‡ªå¸¦çš„ç”µæå¸ƒå±€ç³»ç»Ÿå¯¹çŸ©é˜µè¿›è¡Œé€šé“å®šä½ 2.1 åŠ è½½è„‘åœ°å½¢å›¾ä½ç½®åæ ‡å¹¶å¯è§†åŒ– 123int32_montage = mne.channels.make_standard_montage(&#x27;biosemi32&#x27;)int32_montage.plot()plt.show() 2.2 æ„å»ºè‡ªå®šä¹‰32å¯¼è”çš„å­—å…¸ï¼Œå¯¼è”åç§°ä¸å¯¼è”æƒé‡ä¸€ä¸€å¯¹åº” 1weight = &#123;&#x27;Fp1&#x27;: 0.31, &#x27;AF3&#x27;: -0.26, &#x27;F7&#x27;: 1.22, &#x27;F3&#x27;: 0.99, &#x27;Fz&#x27;: 0.71, &#x27;FC5&#x27;: 0.55, &#x27;FC1&#x27;: -1.19, &#x27;T7&#x27;: 0.61, &#x27;C3&#x27;: -0.80, &#x27;Cz&#x27;: 2.36, &#x27;CP5&#x27;: -0.74, &#x27;CP1&#x27;: 0.72, &#x27;P7&#x27;: 0.93, &#x27;P3&#x27;: 0.38, &#x27;Pz&#x27;: 1.07, &#x27;PO3&#x27;: -1.46, &#x27;O1&#x27;: -0.12, &#x27;Oz&#x27;: 1.074, &#x27;Fp2&#x27;: 1.04, &#x27;AF4&#x27;: -0.065, &#x27;F4&#x27;: -0.52, &#x27;F8&#x27;: 0.37, &#x27;FC2&#x27;: 1.30, &#x27;FC6&#x27;: 0.94, &#x27;C4&#x27;: -1.11, &#x27;T8&#x27;: -0.16, &#x27;CP2&#x27;: 1.82, &#x27;CP6&#x27;: 0.41, &#x27;P4&#x27;: 0.46, &#x27;P8&#x27;: 0.99, &#x27;PO4&#x27;:0.15, &#x27;O2&#x27;:0.23&#125; 2.3 æ ¹æ®è„‘åœ°å½¢å›¾å¯¼è”é¡ºåºé‡æ„è‡ªå®šä¹‰çŸ©é˜µï¼ˆ*æ³¨æ„ï¼‰ 1234567891011# æŸ¥çœ‹è„‘åœ°å½¢å›¾çŸ©é˜µå¯¼è”ä½ç½®sensor_data_32 = int32_montage.get_positions()[&#x27;ch_pos&#x27;]sensor_dataframe_32 = pd.DataFrame(sensor_data_32).TchLa_index = sensor_dataframe_32.index.valuesprint(chLa_index)# é‡æ„è‡ªå®šä¹‰çŸ©é˜µé¡ºåºreWeight = []for key in chLa_index: val = weight[key] reWeight.append(val) 2.4 TopoMapå¯è§†åŒ– 2.4.1 åˆ›å»ºinfo 12345info = mne.create_info( ch_names = chLa_index, ch_types = [&#x27;eeg&#x27;]*32, # é€šé“ä¸ªæ•° sfreq = 1000) # é‡‡æ ·é¢‘ç‡info.set_montage(int32_montage) 2.4.2 å¯è§†åŒ– 1234567im, cn = mne.viz.plot_topomap(reWeight, info, names = chLa_index.tolist(), # vlim=(-2, 2) )plt.colorbar(im)plt.show() 3ã€è‡ªå®šä¹‰ç”µæå¸ƒå±€æ–‡ä»¶å¯¹çŸ©é˜µè¿›è¡Œé€šé“å®šä½ å‡è®¾æˆ‘æœ‰ä¸€ä¸ª64å¯¼è”çš„å¸½å­ï¼Œæ ¹æ®å®éªŒéœ€æ±‚ï¼Œå®éªŒè¿‡ç¨‹ä¸­æˆ‘åªé€‰æ‹©ä¸­å¤®åŒºå’Œé¡¶å¶åŒºåŸŸçš„ç”µæã€‚ é‚£ä¹ˆæˆ‘ä»¬è¯¥å¦‚ä½•æ ¹æ®è‡ªå·±é€‰æ‹©çš„å¯¼è”åˆ¶å®šé€šé“å®šä½æ¨¡ç‰ˆå‘¢ï¼Ÿ è¿™é‡Œæœ‰ä¸¤ç§æ–¹æ³•ï¼š ç¬¬ä¸€ç§ï¼šè‡ªå®šä¹‰æ–°çš„ç”µæå¸ƒå±€æ–‡ä»¶ï¼Œæ–‡ä»¶åªåŒ…å«å®éªŒé€‰æ‹©çš„å¯¼è”ã€‚è¿™ä¸ªæ–¹æ³•çš„ç›®çš„æ˜¯æ•™ä¼šä½ å¦‚ä½•åˆ¶ä½œè‡ªå·±çš„ç”µæå¸ƒå±€æ–‡ä»¶ï¼Œå®é™…ç»˜åˆ¶æ—¶å»ºè®®é€‰æ‹©ç¬¬äºŒç§æ–¹æ³•ã€‚ ç¬¬äºŒç§ï¼šä½¿ç”¨åŸæ¥çš„ç”µæå¸ƒå±€æ–‡ä»¶ï¼Œå…ˆå¯¹çŸ©é˜µè¿›è¡Œå½’ä¸€åŒ–ï¼Œåå°†æœªè¢«é€‰æ‹©çš„å¯¼è”å€¼ç½®ä¸º0 4ã€ç¬¬ä¸€ç§æ–¹æ³• 4.1 ä¸‹è½½æ ‡å‡†çš„64é€šé“ç”µæå¸ƒå±€ç³»ç»Ÿåæ ‡ 12345# è¯»å–MNEä¸­biosemi64ç”µæä½ç½®ä¿¡æ¯biosemi_montage = mne.channels.make_standard_montage(&#x27;biosemi64&#x27;)sensor_data_64 = biosemi_montage.get_positions()[&#x27;ch_pos&#x27;]sensor_dataframe_64 = pd.DataFrame(sensor_data_64).Tsensor_dataframe_64.to_excel(&#x27;sensor_dataframe_64.xlsx&#x27;) 4.2 æ ¹æ®ä¸‹è½½æ–‡ä»¶ï¼Œé€‰æ‹©å®éªŒé€‰å–çš„ç”µæåæ ‡ï¼Œä¿å­˜ä¸ºexcelæ ¼å¼ 1# æ¨¡ä»¿ä¸‹è½½çš„ç”µæå¸ƒå±€excelï¼Œè‡ªå®šä¹‰ç”µæå¸ƒå±€æ–‡ä»¶ 4.3 åŠ è½½è‡ªå®šä¹‰çš„excelæ–‡ä»¶ï¼Œåˆ¶ä½œè‡ªå·±çš„montage 1234567myStardart = pd.read_excel(&#x27;mySensor_dataframe.xlsx&#x27;, index_col=0) # è¯»å–è‡ªå·±çš„ç”µæå®šä½æ–‡ä»¶ch_names = np.array(myStardart.index) # ç”µæåç§°position = np.array(myStardart) # ç”µæåæ ‡ä½ç½®sensorPosition = dict(zip(ch_names, position)) # åˆ¶å®šä¸ºå­—å…¸çš„å½¢å¼myMontage = mne.channels.make_dig_montage(ch_pos=sensorPosition)myMontage.plot()plt.show() 4.4 è‡ªå®šä¹‰å¯¼è”æƒé‡å­—å…¸ 1234myWeight = &#123;&#x27;C1&#x27;: 0.31, &#x27;C3&#x27;: 1.22, &#x27;P6&#x27;: 0.71, &#x27;P4&#x27;: 0.55,&#x27;P2&#x27;: -1.19, &#x27;CP5&#x27;: 0.61, &#x27;CP3&#x27;: -0.80, &#x27;CP1&#x27;: 2.36, &#x27;P1&#x27;: -0.74, &#x27;P3&#x27;: 0.72,&#x27;P5&#x27;: 0.93, &#x27;Pz&#x27;: -1.46, &#x27;CPz&#x27;: -0.12, &#x27;Cz&#x27;: 1.074,&#x27;C5&#x27;:2.34,&#x27;C2&#x27;: 1.04, &#x27;C4&#x27;: -0.065, &#x27;C6&#x27;: -0.52, &#x27;CP2&#x27;: 0.37, &#x27;CP4&#x27;: 1.30, &#x27;CP6&#x27;: 0.94&#125; 4.5 æ ¹æ®è„‘åœ°å½¢å›¾å¯¼è”é¡ºåºé‡æ„è‡ªå®šä¹‰çŸ©é˜µï¼ˆ*æ³¨æ„ï¼‰ 123456789# æŸ¥çœ‹è„‘åœ°å½¢å›¾çŸ©é˜µå¯¼è”ä½ç½®my_chLa_index = ch_names.tolist()print(&#x27;è„‘åœ°å½¢å›¾çŸ©é˜µå¯¼è”é¡ºåº:&#x27;,my_chLa_index)# é‡æ„è‡ªå®šä¹‰çŸ©é˜µé¡ºåºreMyWeight = []for key in my_chLa_index: val = myWeight[key] reMyWeight.append(val) 4.6 TopoMapå¯è§†åŒ– 4.6.1 åˆ›å»ºinfo 12345myinfo = mne.create_info( ch_names = my_chLa_index, ch_types = [&#x27;eeg&#x27;]*21, # é€šé“ä¸ªæ•° sfreq = 1000) # é‡‡æ ·é¢‘ç‡myinfo.set_montage(myMontage) 4.6.2 å¯è§†åŒ– 12345678im, cn = mne.viz.plot_topomap(reMyWeight, myinfo, names = my_chLa_index, # vlim=(-2, 2) )plt.colorbar(im)plt.title(&#x27;My Montage&#x27;)plt.show() 5ã€ç¬¬äºŒç§æ–¹æ³• 5.1 è¯»å–æ ‡å‡†çš„64é€šé“ç”µæå¸ƒå±€ç³»ç»Ÿåæ ‡ 1234567# è¯»å–MNEä¸­biosemi64ç”µæä½ç½®ä¿¡æ¯biosemi_montage = mne.channels.make_standard_montage(&#x27;biosemi64&#x27;)sensor_data_64 = biosemi_montage.get_positions()[&#x27;ch_pos&#x27;]sensor_dataframe_64 = pd.DataFrame(sensor_data_64).TchLa_index_64 = sensor_dataframe_64.index.valuesbiosemi_montage.plot()plt.show() 5.2 æ„å»ºè‡ªå®šä¹‰éƒ¨åˆ†å¯¼è”å­—å…¸ 1234myWeight = &#123;&#x27;C1&#x27;: 0.31, &#x27;C3&#x27;: 1.22, &#x27;P6&#x27;: 0.71, &#x27;P4&#x27;: 0.55,&#x27;P2&#x27;: -1.19, &#x27;CP5&#x27;: 0.61, &#x27;CP3&#x27;: -0.80, &#x27;CP1&#x27;: 2.36, &#x27;P1&#x27;: -0.74, &#x27;P3&#x27;: 0.72,&#x27;P5&#x27;: 0.93, &#x27;Pz&#x27;: -1.46, &#x27;CPz&#x27;: -0.12, &#x27;Cz&#x27;: 1.074,&#x27;C5&#x27;:2.34,&#x27;C2&#x27;: 1.04, &#x27;C4&#x27;: -0.065, &#x27;C6&#x27;: -0.52, &#x27;CP2&#x27;: 0.37, &#x27;CP4&#x27;: 1.30, &#x27;CP6&#x27;: 0.94&#125; 5.3 å¯¹å­—å…¸çš„å€¼è¿›è¡Œå½’ä¸€åŒ– 123456789101112norMyWeiht = myWeight.copy()# Step 1: è·å–éœ€è¦å½’ä¸€åŒ–çš„å€¼values = [v for v in norMyWeiht.values()]# Step 2: æ‰¾åˆ°æœ€å°å€¼å’Œæœ€å¤§å€¼min_value = min(values)max_value = max(values)# Step 3: å¯¹å€¼è¿›è¡Œå½’ä¸€åŒ–è®¡ç®—for key, value in norMyWeiht.items(): normalized_value = (value - min_value) / (max_value - min_value) norMyWeiht[key] = normalized_value 5.4 æ ¹æ®è„‘åœ°å½¢å›¾å¯¼è”é¡ºåºé‡æ„æ ‡å‡†åŒ–åçš„çŸ©é˜µï¼Œå°†æœªè¢«é€‰æ‹©çš„å¯¼è”å€¼ç½®ä¸º0 123456789print(&#x27;è„‘åœ°å½¢å›¾çŸ©é˜µå¯¼è”é¡ºåº:&#x27;,chLa_index_64)# é‡æ„è‡ªå®šä¹‰çŸ©é˜µé¡ºåºreNorMyWeight = []for key in chLa_index_64: if key in norMyWeiht: val = norMyWeiht[key] reNorMyWeight.append(val) else: reNorMyWeight.append(0) 5.5 TopoMapå¯è§†åŒ– 5.5.1 åˆ›å»ºinfo 12345info = mne.create_info( ch_names = chLa_index_64.tolist(), ch_types = [&#x27;eeg&#x27;]*len(reNorMyWeight), # é€šé“ä¸ªæ•° sfreq = 1000) # é‡‡æ ·é¢‘ç‡info.set_montage(biosemi_montage) 5.5.2 å¯è§†åŒ– 123456789im, cn = mne.viz.plot_topomap(reNorMyWeight, info, names = chLa_index_64, cmap = &#x27;jet&#x27; # vlim=(-2, 2) )plt.colorbar(im)plt.title(&#x27;My Montage&#x27;)plt.show() 6ã€ä»£ç ä¸‹è½½ https://github.com/weisihong9/EEG_TopoMap.git","categories":[{"name":"EEG","slug":"EEG","permalink":"https://weisihong9.github.io/categories/EEG/"},{"name":"BEAM","slug":"EEG/BEAM","permalink":"https://weisihong9.github.io/categories/EEG/BEAM/"}],"tags":[{"name":"BEAM","slug":"BEAM","permalink":"https://weisihong9.github.io/tags/BEAM/"}]},{"title":"Using_Markdown_writing","slug":"Using_Markdown_writing","date":"2023-05-21T08:54:43.000Z","updated":"2024-05-15T02:29:43.598Z","comments":true,"path":"2023/05/21/Using_Markdown_writing/","link":"","permalink":"https://weisihong9.github.io/2023/05/21/Using_Markdown_writing/","excerpt":"","text":"è‡ªåŠ¨æ·»åŠ ç›®å½• åœ¨å‰å¤´æ·»åŠ ï¼štoc: true è‡ªåŠ¨ç¼–å·å¾ˆçƒ¦ï¼Œè¿˜ä¸çŸ¥é“å’‹è§£å†³ è¿™æ˜¯ä¸€çº§æ ‡é¢˜ ä¸‹é¢å¼€å§‹è¯´æ˜å¦‚ä½•ä½¿ç”¨markdownè¿›è¡Œå†™ä½œ è¿™æ˜¯äºŒçº§æ ‡é¢˜ è¿™æ˜¯æ­£æ–‡ æ¢ä¸€è¡Œï¼Ÿ ï¼ˆåœ¨ä¸Šä¸€è¡Œåé¢æŒ‰ä¸¤æ¬¡ç©ºæ ¼ï¼Œå†å›è½¦å°±æ˜¯æ¢ä¸€è¡Œï¼‰ æ¢ä¸€æ®µï¼ˆæŒ‰ä¸¤æ¬¡æ¢è¡Œå°±æ˜¯æ¢ä¸€æ®µï¼‰ 0 å„ç§ç¬¦å· æ¨ªçº¿éš”å¼€ a b [X] c [X] d æ ‡æ³¨ 1 å¼ºè°ƒ åŠ ç²—äº†: å‰åå„åŠ ä¸¤ä¸ª*å· æ–œä½“ï¼šå‰åå„åŠ ä¸€ä¸ªæ˜Ÿå· 2 åˆ—è¡¨ è‡ªåŠ¨ç¼–å·ï¼šæ•°å­— + ç‚¹ + ç©ºæ ¼å³å¯ æ¥ä¸€ä¸ªäºŒçº§æ ‡é¢˜ æŒ‰ä¸€ä¸‹å›è½¦ï¼Œå†tabå°±è¡Œ å†æ¥ä¸€ä¸ªä¸‰çº§æ ‡é¢˜ æŒ‰å›è½¦ï¼Œå†æŒ‰tab ç»§ç»­å›è½¦ï¼Œå†tab 3 æ’å…¥å›¾ç‰‡ï¼šå›¾åºŠä¸Šä¼ å›¾ç‰‡ æŠŠå›¾ç‰‡å…ˆä¸Šä¼ åˆ°è‡ªå·±çš„å›¾åºŠï¼Œç„¶åå¤åˆ¶ç”Ÿæˆçš„å›¾ç‰‡é“¾æ¥ã€‚ æ ¼å¼ä¸ºï¼š!+[å›¾ç‰‡åå­—]+(http:\\â€¦â€¦png) å›¾ç‰‡æ³¨é‡Š æˆ–è€…ï¼š 4 æ•°å­¦å…¬å¼ limâ¡xâ†’âˆsin(x)x=1\\lim_{x \\to \\infin}\\frac{sin(x)}{x}=1 xâ†’âˆlimâ€‹xsin(x)â€‹=1 åœ¨ä¸€æ®µæ–‡å­—ä¸­æ’å…¥å…¬å¼: limâ¡xâ†’âˆf(x)\\lim_{x \\to \\infin}f(x)limxâ†’âˆâ€‹f(x), command + m å¿«æ·é”®è¿æŒ‰ä¸¤æ¬¡å°±å¯ä»¥ç”Ÿæˆ4ä¸ªç¾å…ƒç¬¦å·ç„¶åè¾“å…¥å…¬å¼ 5 è¡¨æ ¼ EMD HHT HHSA 1 2 3 å·¦å¯¹å…¶ å±…ä¸­å¯¹é½ å³å¯¹é½ è°ƒæ•´ç¼–è¾‘éƒ¨åˆ†è¡¨æ ¼æ ¼å¼å¿«æ·é”®ï¼š å…ˆé€‰ä¸­è¡¨æ ¼å†…å®¹ï¼Œç„¶åï¼šAltï¼ˆfn+optionï¼‰ + shift + f 6 æ’å…¥é“¾æ¥ å¤åˆ¶ç½‘å€ï¼Œç„¶åé€‰ä¸­è¦ç»™è¶…é“¾æ¥çš„æ–‡å­—ï¼Œç›´æ¥ï¼šcommand + v å°±è¡Œ è¿™æ˜¯ä¸€ä¸ªlaTexçš„é“¾æ¥ 7 code è‹±æ–‡çš„ä¸‰ä¸ªå°ç‚¹ï¼š1å·¦è¾¹çš„é‚£ä¸ªé”® 12# ``` javascript# ``` 1234import numpy as npfrom PyEMD import EMDimport matplotlib.pyplot as plt 8 å¯¼èˆª 9 å°†mdæ–‡ä»¶å¯¼å‡ºä¸ºpdf é¦–å…ˆä¸‹è½½è¿™ä¸ªæ’ä»¶ï¼šMarkdown Preview Enhanced ç„¶å command + shift + v æ‰“å¼€ Preview **.md ç•Œé¢ æœ€ååœ¨ Preview **.md ç•Œé¢ï¼Œå³é”®ï¼Œç„¶åé€‰ä¸­ï¼šChrome(Puppeteer) --&gt; PDF å³å¯ 10 è¿™æ˜¯è¯¥mdæ–‡ä»¶çš„ä¸‹è½½é“¾æ¥ï¼ ä¸‹è½½","categories":[],"tags":[{"name":"Markdown","slug":"Markdown","permalink":"https://weisihong9.github.io/tags/Markdown/"}]},{"title":"EMD","slug":"EMD","date":"2023-05-20T16:58:43.000Z","updated":"2023-05-21T15:59:47.986Z","comments":true,"path":"2023/05/21/EMD/","link":"","permalink":"https://weisihong9.github.io/2023/05/21/EMD/","excerpt":"","text":"ç›®çš„ï¼šåˆ©ç”¨pythonè‡ªå¸¦çš„ pyEMD å®ç° ç»éªŒæ¨¡æ€åˆ†è§£ï¼ˆEMDï¼‰ 1 åŠ è½½pythonåº“ 123import numpy as npfrom PyEMD import EMDimport matplotlib.pyplot as plt 2 EMDåˆ†è§£ 12345678910111213141516171819202122# ç”Ÿæˆç¤ºä¾‹ä¿¡å·t = np.linspace(0, 1, 1000)signal = np.sin(5 * 2 * np.pi * t) + np.sin(10 * 2 * np.pi * t)# åˆ›å»ºEMDå¯¹è±¡emd = EMD()# æ‰§è¡ŒEMDåˆ†è§£IMFs = emd(signal)# ç»˜åˆ¶åˆ†è§£åçš„IMFsplt.figure(figsize=(10, 6),dpi=600)plt.subplot(len(IMFs) + 1, 1, 1)plt.plot(t, signal, &#x27;b&#x27;)plt.title(&#x27;Original Signal&#x27;)for i, IMF in enumerate(IMFs): plt.subplot(len(IMFs) + 1, 1, i + 2) plt.plot(t, IMF, &#x27;r&#x27;) plt.title(&#x27;IMF %d&#x27; % (i + 1))plt.tight_layout()plt.show() 3 ç»“æŸ","categories":[{"name":"Signal processing","slug":"Signal-processing","permalink":"https://weisihong9.github.io/categories/Signal-processing/"},{"name":"EMD","slug":"Signal-processing/EMD","permalink":"https://weisihong9.github.io/categories/Signal-processing/EMD/"}],"tags":[{"name":"EMD","slug":"EMD","permalink":"https://weisihong9.github.io/tags/EMD/"}]},{"title":"Hello World","slug":"hello-world","date":"2023-05-20T10:35:24.631Z","updated":"2023-05-20T10:35:24.632Z","comments":true,"path":"2023/05/20/hello-world/","link":"","permalink":"https://weisihong9.github.io/2023/05/20/hello-world/","excerpt":"","text":"Welcome to Hexo! This is your very first post. Check documentation for more info. If you get any problems when using Hexo, you can find the answer in troubleshooting or you can ask me on GitHub. Quick Start Create a new post 1$ hexo new &quot;My New Post&quot; More info: Writing Run server 1$ hexo server More info: Server Generate static files 1$ hexo generate More info: Generating Deploy to remote sites 1$ hexo deploy More info: Deployment","categories":[],"tags":[]}],"categories":[{"name":"Signal processing","slug":"Signal-processing","permalink":"https://weisihong9.github.io/categories/Signal-processing/"},{"name":"EEG","slug":"EEG","permalink":"https://weisihong9.github.io/categories/EEG/"},{"name":"ERSP","slug":"EEG/ERSP","permalink":"https://weisihong9.github.io/categories/EEG/ERSP/"},{"name":"FBN","slug":"EEG/FBN","permalink":"https://weisihong9.github.io/categories/EEG/FBN/"},{"name":"Graph","slug":"Graph","permalink":"https://weisihong9.github.io/categories/Graph/"},{"name":"EEG","slug":"Graph/EEG","permalink":"https://weisihong9.github.io/categories/Graph/EEG/"},{"name":"BEAM","slug":"EEG/BEAM","permalink":"https://weisihong9.github.io/categories/EEG/BEAM/"},{"name":"EMD","slug":"Signal-processing/EMD","permalink":"https://weisihong9.github.io/categories/Signal-processing/EMD/"}],"tags":[{"name":"EEG_fNIRS_EMG","slug":"EEG-fNIRS-EMG","permalink":"https://weisihong9.github.io/tags/EEG-fNIRS-EMG/"},{"name":"ERSP","slug":"ERSP","permalink":"https://weisihong9.github.io/tags/ERSP/"},{"name":"FBN","slug":"FBN","permalink":"https://weisihong9.github.io/tags/FBN/"},{"name":"BEAM","slug":"BEAM","permalink":"https://weisihong9.github.io/tags/BEAM/"},{"name":"CFC","slug":"CFC","permalink":"https://weisihong9.github.io/tags/CFC/"},{"name":"Markdown","slug":"Markdown","permalink":"https://weisihong9.github.io/tags/Markdown/"},{"name":"EMD","slug":"EMD","permalink":"https://weisihong9.github.io/tags/EMD/"}]}